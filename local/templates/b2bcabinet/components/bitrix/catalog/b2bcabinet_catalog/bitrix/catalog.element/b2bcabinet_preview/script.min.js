"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var l=t[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var quickViewPs;document.addEventListener("DOMContentLoaded",function(){document.querySelector(".quick-view__main-content")&&(quickViewPs=new PerfectScrollbar(".quick-view__main-content",{wheelSpeed:.5,wheelPropagation:!0,minScrollbarLength:20}))});var QuickView=function(){function e(t){return _classCallCheck(this,e),"object"===_typeof(e.instance)?e.instance:(e.instance=this,this.selector=t,this.quantity_hide=0,this)}return _createClass(e,[{key:"init",value:function(){var e=document.querySelector(this.selector),t=e.querySelectorAll(".tabs-list__item"),i=e.querySelectorAll(".tabs-content"),l=e.querySelector(".input-wrap__minus"),n=e.querySelector(".input-wrap__plus"),r=e.querySelector(".input-wrap__input"),o=e.querySelectorAll(".gallery-item__link"),a=e.querySelector(".gallery-block"),c=e.querySelector(".gallery-slider"),s=e.querySelector(".gallery-slider__btn-wrap"),u=e.querySelectorAll(".filter-prop-item__item"),d=e.querySelector(".offers-block__btn-openup"),y=e.querySelectorAll(".quantity-wrap__minus"),f=e.querySelectorAll(".quantity-wrap__plus"),p=e.querySelectorAll(".offers-block__item"),h=[],_=[],v=e.querySelector(".quick-view__main-content"),m=e.querySelector(".quick-view__shadow");v.addEventListener("scroll",function(){m.style.bottom=-1*v.scrollTop+"px",m.style.display=this.offsetHeight+this.scrollTop===this.scrollHeight?"none":"block"});for(var b=0;b<f.length;b++)f[b].addEventListener("click",function(){for(var e=0;e<this.parentNode.children.length;e++)this.parentNode.children[e].classList.contains("quantity-wrap__input")&&(isNaN(this.parentNode.children[e].value)||this.parentNode.children[e].value++)});for(var k=0;k<y.length;k++)y[k].addEventListener("click",function(){for(var e=0;e<this.parentNode.children.length;e++)this.parentNode.children[e].classList.contains("quantity-wrap__input")&&!isNaN(this.parentNode.children[e].value)&&+this.parentNode.children[e].value>0&&this.parentNode.children[e].value--});for(var q=function(e){h[e]=p[e].querySelectorAll(".prop-block__item"),_[e]=p[e].querySelector(".prop-block__show-more");for(var t=3;t<h[e].length;t++)h[e][t].style.display="none";_[e]&&_[e].addEventListener("click",function(){for(var t=3;t<h[e].length;t++)"none"===h[e][t].style.display?(h[e][t].style.display="list-item",_[e].textContent=BX.message("JS_HIDE")):(h[e][t].style.display="none",_[e].textContent=BX.message("JS_SHOW_ALL"))})},S=0;S<p.length;S++)q(S);d&&d.addEventListener("click",this.filterBlockHide.bind(this));for(var L=0;L<u.length;L++)u[L].addEventListener("click",function(){this.classList.toggle("active")});for(var g=function(e){var l=e;t[l].addEventListener("click",function(){$.fancybox.close(),c.style.display="none",this.classList.contains("item-tab-gallery")&&(a.style.display="block",c.style.display="none");for(var e=0;e<i.length;e++)i[e].classList.remove("active"),t[e].classList.remove("active");this.classList.add("active"),i[l].classList.add("active"),quickViewPs&&quickViewPs.update(),document.querySelector(".quick-view__main-content").scrollTop=0})},w=0;w<t.length;w++)g(w);l&&l.addEventListener("click",function(){!isNaN(r.value)&&+r.value>0&&r.value--}),n&&n.addEventListener("click",function(){isNaN(r.value)||r.value++});for(var A=0;A<o.length;A++)o[A].addEventListener("click",function(e){if("block"===c.style.display)e.preventDefault();else{for(var l=0;l<t.length;l++)i[l].classList.remove("active"),t[l].classList.remove("active"),t[l].classList.contains("item-tab-gallery")&&(i[l].classList.add("active"),t[l].classList.add("active"));a.style.display="none",c.style.display="block"}});s&&s.addEventListener("click",function(){a.style.display="block",c.style.display="none",$.fancybox.close()}),this.setQuantityHide(),this.itemsSortDetail(),window.addEventListener("resize",this.setQuantityHide.bind(this))}},{key:"filterBlockHide",value:function(){for(var e=document.querySelectorAll(".filter-block__item"),t=document.querySelector(".offers-block__btn-openup"),i=document.querySelector(".offers-block__filter"),l=document.querySelector(".btn-openup__text"),n=this.quantity_hide;n<e.length;n++)"none"===e[n].style.display?(e[n].style.display="flex",t.classList.add("opened"),i.classList.remove("filter-block-hide"),l.textContent=BX.message("JS_HIDE")):(e[n].style.display="none",t.classList.remove("opened"),l.textContent=BX.message("JS_FILTER"),0===this.quantity_hide&&i.classList.add("filter-block-hide"))}},{key:"setQuantityHide",value:function(){var e=document.querySelector(".offers-block__filter"),t=document.querySelector(".offers-block__btn-openup-wrap"),i=document.querySelectorAll(".filter-block__item"),l=document.querySelector(".offers-block__btn-openup"),n=document.querySelector(".btn-openup__text");if(t&&(window.matchMedia("(min-width: 831px)").matches?i.length<4&&t.classList.add("hidden"):t.classList.remove("hidden")),i.length)for(var r=0;r<i.length;r++)i[r].style.display="flex";l&&l.classList.remove("opened"),window.matchMedia("(max-width: 830px)").matches?(this.quantity_hide=0,e&&(e.classList.add("filter-block-hide"),t&&(n.textContent=BX.message("JS_FILTER")))):(this.quantity_hide=3,e&&e.classList.remove("filter-block-hide"));for(var o=this.quantity_hide;o<i.length;o++)i[o].style.display="none"}},{key:"itemsSortDetail",value:function(){Array.prototype.slice.call(document.querySelectorAll(".filter-prop-item__item")).forEach(function(e){e.addEventListener("click",function(){var e=getParent(this,"offers-block"),t=getParent(this,"filter-block__item");t.querySelector(".active")?t.classList.add("checked"):t.classList.remove("checked");var i=Array.prototype.slice.call(e.querySelectorAll(".filter-block__item.checked")).length,l=Array.prototype.slice.call(e.querySelectorAll(".offers-block__item")),n=l.map(function(e){return Array.prototype.slice.call(e.querySelectorAll("[data-propvalue]"))}).map(function(e){return e.map(function(e){return o({},e.getAttribute("data-propname"),e.getAttribute("data-propvalue"))})}),r=Array.prototype.slice.call(e.querySelectorAll(".filter-block__item .filter-prop-item__item-wrap")).map(function(e){return Array.prototype.slice.call(e.querySelectorAll(".active[data-value]"))}).map(function(e){return e.map(function(e){return o({},e.getAttribute("data-name"),e.getAttribute("data-value"))})});function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}n.forEach(function(e,t){var n=[];e.forEach(function(e){var i=function(i){r.forEach(function(l){l.forEach(function(l){e[i]===l[i]&&n.push(t)})})};for(var l in e)i(l)}),i===n.length?l[t].classList.remove("hide"):l[t].classList.add("hide")})})})}}]),e}();function getParent(e,t){for(var i=e;!i.classList.contains(t)&&i!==document.body;)i=i.parentElement;if(i!==document.body)return i}