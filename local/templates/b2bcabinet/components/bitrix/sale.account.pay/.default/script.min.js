BX.saleAccountPay=function(){var t=function(t){this.siteId=t.siteId,this.messages=t.alertMessages||{},this.nameValue=t.nameValue||"buyMoney",this.ajaxUrl=t.url,this.signedParams=t.signedParams||{},this.wrapperId=t.wrapperId||"",this.templateFolder=t.templateFolder,this.wrapper=document.getElementById("bx-sap"+this.wrapperId),this.changeInputContainer=this.wrapper.getElementsByClassName("js-fixedpay-container")[0],this.inputElement=this.wrapper.getElementsByClassName("js-sale-accountpay-input")[0],this.submitButton=this.wrapper.getElementsByClassName("blank_invoices-pay_button")[0],BX.ready(BX.proxy(this.init,this))};return t.prototype.init=function(){return BX.bind(this.inputElement,"input",BX.delegate(function(){this.inputElement.value=this.inputElement.value.replace(/[^\d,.]*/g,"").replace(/\,/g,".").replace(/([,.])[,.]+/g,"$1").replace(/^[^\d]*(\d+([.,]\d{0,5})?).*$/g,"$1"),this.removeActivePayBtn()},this)),BX.bindDelegate(this.changeInputContainer,"click",{className:"js-fixedpay-item"},BX.proxy(function(t){this.inputElement.value=parseInt(t.target.innerText),this.setActivePayBtn(t.target)},this)),BX.bind(this.submitButton,"click",BX.delegate(function(t){if(t.preventDefault(),parseFloat(this.inputElement.value)<=0||""==this.inputElement.value)return window.alert(BX.util.htmlspecialchars(this.messages.wrongInput)),!1;BX.showWait(),BX.ajax({method:"POST",dataType:"html",url:this.ajaxUrl,data:{sessid:BX.bitrix_sessid(),buyMoney:this.inputElement.value,paySystemId:this.wrapper.querySelector(".nav-link.blank_personal-payment_method-button.active.show").dataset.id,signedParamsString:this.signedParams,SITE_ID:this.siteId},onsuccess:BX.proxy(function(t){for(;this.wrapper.firstChild;)this.wrapper.removeChild(this.wrapper.firstChild);this.wrapper.innerHTML=t,BX.closeWait()},this),onfailure:BX.proxy(function(){return this},this)},this)},this)),this},t.prototype.setActivePayBtn=function(t){this.removeActivePayBtn(),t.classList.add("active")},t.prototype.removeActivePayBtn=function(){const t=this.changeInputContainer.querySelector(".js-fixedpay-item.active");t&&t.classList.remove("active")},t.prototype.destroy=function(){this.messages=null,this.nameValue=null,this.signedParams=null,this.changeInputContainer=null,this.inputElement=null,this.submitButton=null},t.prototype.startLoader=function(){return!0!==this.BXFormPosting&&(this.BXFormPosting=!0,this.loadingScreen||(this.loadingScreen=new BX.PopupWindow("loading_screen",this.submitButton,{overlay:{backgroundColor:"white",opacity:"80"},autoHide:!0,events:{onAfterPopupShow:BX.proxy(function(){BX.cleanNode(this.loadingScreen.popupContainer),this.loadingScreen.popupContainer.appendChild(BX.create("IMG",{props:{src:this.templateFolder+"/images/loader.gif"}})),this.loadingScreen.popupContainer.removeAttribute("style"),this.loadingScreen.popupContainer.style.display="block"},this)}})),this.loadingScreen.show())},t.prototype.endLoader=function(t){this.BXFormPosting=!1,this.loadingScreen&&this.loadingScreen.isShown()&&this.loadingScreen.close(),clearTimeout(t)},t}();