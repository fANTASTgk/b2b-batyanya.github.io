!function(t){"use strict";t.JCBlankZakazaItem||(t.JCBlankZakazaItem=function(t,e){switch(this.DEBOUNCE_TIME=500,this.arResult=t,this.arParams=e,this.itemId=t.ITEM.ID,this.node=document.getElementById(t.ITEM_IDS.ID),this.productType=t.ITEM.CATALOG_TYPE,this.showAbsent=!0,this.showSkuProps=!1,this.nodesQuantity={wrapper:document.getElementById(t.ITEM_IDS.QUANTITY),increment:document.getElementById(t.ITEM_IDS.QUANTITY_INCREMENT),value:document.getElementById(t.ITEM_IDS.QUANTITY_VALUE),decrement:document.getElementById(t.ITEM_IDS.QUANTITY_DECREMENT)},this.nodePict=document.getElementById(t.ITEM_IDS.PICTURE),this.nodeAvaliable=this.node.querySelector(".product__quant"),this.nodePrices=this.node.querySelectorAll('[data-entity="price-block"] .wrap-product__property--price'),this.nodePriceMobile=this.node.querySelector(".product__property--price-mobile"),this.nodeEmptyOffer=document.getElementById(t.ITEM_IDS.OFFER_ROW_EMPTY),this.nodeOffers=null,this.offers={},this.treeProps=[],this.selectedValues={},this.offersTogglerId=t.ITEM_IDS.OFFERS_TOGGLER,this.quantityTrace="Y"===t.ITEM.CATALOG_QUANTITY_TRACE,this.canBuyZero="Y"===t.ITEM.CATALOG_CAN_BUY_ZERO,this.ranges=[],this.prices=t.ITEM.PRINT_PRICES,this.delayAddToBasket=0,this.obQuantity={isSKU:!1,itemId:t.ITEM.ID,name:t.ITEM.NAME,nodes:this.nodesQuantity,currentQuantity:parseFloat(t.ITEM.ACTUAL_QUANTITY)||0,tmpQuantity:parseFloat(t.ITEM.ACTUAL_QUANTITY)||0,maxQuantity:this.quantityTrace&&!this.canBuyZero?parseFloat(t.ITEM.CATALOG_QUANTITY):Number.POSITIVE_INFINITY,minQuantity:0,measureRatio:parseFloat(t.ITEM.CATALOG_MEASURE_RATIO?t.ITEM.CATALOG_MEASURE_RATIO:t.ITEM.ITEM_MEASURE_RATIOS.length>0?t.ITEM.ITEM_MEASURE_RATIOS[t.ITEM.ITEM_MEASURE_RATIO_SELECTED].RATIO:0),measureName:t.ITEM.CATALOG_MEASURE_NAME?t.ITEM.CATALOG_MEASURE_NAME:t.ITEM.ITEM_MEASURE.TITLE},this.blockNodes={},this.obTree=null,this.obSkuProps=null,this.errorCode=0,this.product={canBuy:!0,name:"",pict:{},id:0,addUrl:"",buyUrl:""},this.obPrice=null,this.defaultPict={pict:null,secondPict:null},"object"==typeof e&&(e.PRODUCT_TYPE&&(this.productType=parseInt(e.PRODUCT_TYPE,10)),this.showAbsent=e.SHOW_ABSENT,this.showSkuProps=e.SHOW_SKU_PROPS,this.blockNodes.quantity=this.node.querySelector('[data-entity="quantity-block"]')),this.productType){case 3:e.PRODUCT&&"object"==typeof e.PRODUCT&&(this.product.name=e.PRODUCT.NAME,this.product.id=e.PRODUCT.ID,this.product.DETAIL_PAGE_URL=e.PRODUCT.DETAIL_PAGE_URL,this.product.morePhotoCount=e.PRODUCT.MORE_PHOTO_COUNT,this.product.morePhoto=e.PRODUCT.MORE_PHOTO,e.PRODUCT.RCM_ID&&(this.product.rcmId=e.PRODUCT.RCM_ID)),e.OFFERS&&BX.type.isArray(e.OFFERS)&&0!==e.OFFERS.length&&(this.offerNum=0,this.obQuantity.isSKU=!0,e.OFFER_SELECTED&&(this.offerNum=parseInt(e.OFFER_SELECTED,10)),isNaN(this.offerNum)&&(this.offerNum=0),e.TREE_PROPS&&(this.treeProps=e.TREE_PROPS),e.DEFAULT_PICTURE&&(this.defaultPict.pict=e.DEFAULT_PICTURE.PICTURE,this.defaultPict.secondPict=e.DEFAULT_PICTURE.PICTURE_SECOND),"BLOCK"!==e.OFFERS_VIEW&&(this.nodeOffers=document.getElementById(t.ITEM_IDS.ID+"_offers")));break}BX.ready(BX.delegate(this.init,this))},t.JCBlankZakazaItem.prototype={init:function(){if(this.initRanges(),this.initOffers(),3===parseInt(this.productType)){if(this.initToggler(),"Y"===this.arParams.CATALOG_NOT_AVAILABLE)return;for(let t in this.offers)"BLOCK"!==this.arParams.OFFERS_VIEW&&this.initQuantity(this.offers[t].obQuantity);"LIST"!==this.arParams.OFFERS_VIEW&&(this.initQuantity(this.obQuantity),this.setCurrentOffer()),"BLOCK"!==this.arParams.OFFERS_VIEW&&this.initSearchOffers()}else{if("Y"===this.arParams.CATALOG_NOT_AVAILABLE)return;this.initQuantity(this.obQuantity)}},initToggler:function(){const t=document.getElementById(this.offersTogglerId);t&&t.addEventListener("click",function(e){t.classList.toggle("show"),this.toggleOffers(),$(".blank-zakaza__wrapper").floatingScroll("update")}.bind(this))},initRanges:function(){for(let t in this.prices)return void(this.ranges=Object.keys(this.prices[t]))},initOffers:function(){if(0===this.arResult.ITEM.OFFERS.length&&3!==parseInt(this.productType))return;if(this.arResult.ITEM.OFFERS.forEach(function(t,e){this.offers[e]={id:t.ID,name:t.NAME??this.arResult.ITEM.NAME,sku:t.PROPERTIES[this.arParams.ARTICLE_PROPERTY_OFFERS],picture:t.PICTURE,picture_150:t.PICTURE_150,nodesMainQuantity:this.nodesQuantity,currentQuantity:parseFloat(t.ACTUAL_QUANTITY),tmpQuantity:parseFloat(t.ACTUAL_QUANTITY),maxQuantity:"Y"===t.CATALOG_QUANTITY_TRACE&&"Y"!==t.CATALOG_CAN_BUY_ZERO?parseFloat(t.CATALOG_QUANTITY):Number.POSITIVE_INFINITY,minQuantity:0,measureRatio:parseFloat(t.CATALOG_MEASURE_RATIO?t.CATALOG_MEASURE_RATIO:t.ITEM_MEASURE_RATIOS?t.ITEM_MEASURE_RATIOS[t.ITEM_MEASURE_RATIO_SELECTED].RATIO:0),measureName:t.CATALOG_MEASURE_NAME?t.CATALOG_MEASURE_NAME:t.ITEM_MEASURE.TITLE,quantityTrace:"Y"===t.CATALOG_QUANTITY_TRACE,canBuyZero:"Y"===t.CATALOG_CAN_BUY_ZERO,obQuantity:{currentQuantity:parseFloat(t.ACTUAL_QUANTITY),nodes:this.nodesQuantity},CAN_BUY:t.CAN_BUY,ITEM_PRICE_MODE:t.ITEM_PRICE_MODE,ITEM_PRICES:t.ITEM_PRICES,ITEM_PRICE_SELECTED:t.ITEM_PRICE_SELECTED,ITEM_QUANTITY_RANGES:t.ITEM_QUANTITY_RANGES,ITEM_QUANTITY_RANGE_SELECTED:t.ITEM_QUANTITY_RANGE_SELECTED,CATALOG_QUANTITY:t.CATALOG_QUANTITY,PRICES:t.PRICES,PRINT_PRICES:t.PRINT_PRICES,MIN_PRICE:t.MIN_PRICE};for(let t in this.arParams.OFFERS)if(this.arParams.OFFERS[t].ID==this.offers[e].id){this.offers[e].TREE=this.arParams.OFFERS[t].TREE;break}if("BLOCK"!==this.arParams.OFFERS_VIEW){const t=this.arResult.ITEM_IDS.OFFERS[e];this.offers[e].node=document.getElementById(t.ID),this.offers[e].obQuantity=this.getOfferQuantityPropsById(e)}}.bind(this)),3===this.productType&&(this.obTree=BX(this.arResult.ITEM_IDS.SKU_TREE),this.obTree||(this.errorCode=-256)),"LIST"!==this.arParams.OFFERS_VIEW){const t=this.obTree.querySelectorAll("li");t&&t.length&&t.forEach((t=>{BX.bind(t,"click",BX.delegate(this.selectOfferProp,this))}))}},initQuantity:function(e){if(null===e.nodes)return;const i=e.nodes;BX.addCustomEvent("SidePanel.Slider:onMessage",(t=>{"addProductToBasketFromDetail"===t.eventId&&t.data.id===e.itemId&&(i.value.value=t.data.quantity,e.currentQuantity=t.data.quantity,e.tmpQuantity=t.data.quantity,BX.onCustomEvent("OnBasketChange"))})),BX.addCustomEvent("UpdateQuantityOnRequest",(function(){BX.ajax.runAction("sotbit:b2bcabinet.basket.getBasketItemsQuantity",{}).then((function(t){for(let s in t.data)e.itemId===s&&(e.currentQuantity=parseFloat(t.data[s]),e.tmpQuantity=e.currentQuantity,i.value.value=e.currentQuantity)}),(function(t){}))})),t.addEventListener("message",(function(t){if("object"==typeof t.data)return;const s=JSON.parse(t.data);s.itemId&&s.quantity&&s.itemId===e.itemId&&(e.currentQuantity=parseFloat(s.quantity),e.tmpQuantity=e.currentQuantity,i.value.value=e.currentQuantity)})),"LIST"!==this.arParams.OFFERS_VIEW&&BX.addCustomEvent(e,"UpdateQuantity",(function(t){e.itemId=t.data.id,i.value.value=t.data.quantity,e.currentQuantity=t.data.quantity,e.tmpQuantity=t.data.quantity,e.isSKU&&(e.name=t.data.name||e.name,e.maxQuantity=t.data.maxQuantity||e.maxQuantity,e.minQuantity=t.data.minQuantity||e.minQuantity,e.measureName=t.data.measureName||e.measureName,e.measureRatio=t.data.measureRatio||e.measureRatio)})),i.increment.onclick=function(s){e.currentQuantity=e.tmpQuantity,e.tmpQuantity=parseFloat((Number(e.tmpQuantity)+e.measureRatio).toFixed(3)),e.tmpQuantity<=e.maxQuantity&&e.tmpQuantity>=e.minQuantity&&!isNaN(e.tmpQuantity)?(i.value.value=e.tmpQuantity,this.redrawPrices({id:e.itemId,count:e.tmpQuantity}),clearTimeout(e.delayAddToBasket),e.delayAddToBasket=setTimeout(function(){i.increment.setAttribute("disabled","disabled"),i.increment.firstElementChild.classList.add("spinner-grow"),this.addToBasket(e.itemId,e.tmpQuantity,e.measureRatio).then(function(s){e.currentQuantity=parseFloat(s.data),e.tmpQuantity=e.currentQuantity,i.increment.removeAttribute("disabled"),i.increment.firstElementChild.classList.remove("spinner-grow"),i.value.value=e.currentQuantity;const a=Array.prototype.slice.call(t.frames);e.isProduct&&"BLOCK"===this.arParams.OFFERS_VIEW&&this.offers.length&&this.setCurrentQuantityForOffer(e),this.eventUpdateQuantity(e),a.forEach((function(t){t.postMessage(JSON.stringify({itemId:e.itemId,quantity:e.currentQuantity}),"*")})),BX.onCustomEvent("OnBasketChange"),this.showNotificationSuccess(e)}.bind(this),function(t){this.showNotificationError(t),i.value.value=e.currentQuantity,i.increment.removeAttribute("disabled"),i.increment.firstElementChild.classList.remove("spinner-grow")}.bind(this))}.bind(this),this.DEBOUNCE_TIME)):(s.target.value=e.currentQuantity,e.tmpQuantity=e.currentQuantity)}.bind(this),i.decrement.onclick=function(s){e.currentQuantity=e.tmpQuantity,e.tmpQuantity=parseFloat((e.tmpQuantity-e.measureRatio).toFixed(3)),e.tmpQuantity<=e.maxQuantity&&e.tmpQuantity>=e.minQuantity&&!isNaN(e.tmpQuantity)?(i.value.value=e.tmpQuantity,this.redrawPrices({id:e.itemId,count:e.tmpQuantity}),clearTimeout(e.delayAddToBasket),e.delayAddToBasket=setTimeout(function(){i.decrement.setAttribute("disabled","disabled"),i.decrement.firstElementChild.classList.add("spinner-grow"),this.addToBasket(e.itemId,e.tmpQuantity,e.measureRatio).then(function(s){e.currentQuantity=parseFloat(s.data),e.tmpQuantity=e.currentQuantity,i.decrement.removeAttribute("disabled"),i.decrement.firstElementChild.classList.remove("spinner-grow"),i.value.value=e.currentQuantity;const a=Array.prototype.slice.call(t.frames);e.isSKU&&"BLOCK"===this.arParams.OFFERS_VIEW&&this.setCurrentQuantityForOffer(e),this.eventUpdateQuantity(e),a.forEach((function(t){t.postMessage(JSON.stringify({itemId:e.itemId,quantity:e.currentQuantity}),"*")})),BX.onCustomEvent("OnBasketChange"),this.showNotificationSuccess(e)}.bind(this),function(t){this.showNotificationError(t),i.value.value=e.currentQuantity,i.decrement.removeAttribute("disabled"),i.decrement.firstElementChild.classList.remove("spinner-grow")}.bind(this))}.bind(this),this.DEBOUNCE_TIME)):(s.target.value=e.currentQuantity,e.tmpQuantity=e.currentQuantity)}.bind(this),i.value.oninput=function(s){e.tmpQuantity=""===s.target.value?0:s.target.value,e.tmpQuantity>e.maxQuantity&&(e.tmpQuantity=e.maxQuantity),e.tmpQuantity<=e.maxQuantity&&e.tmpQuantity>=e.minQuantity&&!isNaN(parseFloat(e.tmpQuantity))?(i.value.value=e.tmpQuantity,this.redrawPrices({id:e.itemId,count:e.tmpQuantity}),clearTimeout(e.delayAddToBasket),e.delayAddToBasket=setTimeout(function(){this.addToBasket(e.itemId,e.tmpQuantity,e.measureRatio).then(function(s){e.currentQuantity=parseFloat(s.data),e.tmpQuantity=e.currentQuantity,i.value.value=e.currentQuantity;const a=Array.prototype.slice.call(t.frames);e.isSKU&&"BLOCK"===this.arParams.OFFERS_VIEW&&this.setCurrentQuantityForOffer(e),this.eventUpdateQuantity(e),a.forEach((function(t){t.postMessage(JSON.stringify({itemId:e.itemId,quantity:e.currentQuantity}),"*")})),BX.onCustomEvent("OnBasketChange"),this.showNotificationSuccess(e)}.bind(this),function(t){this.showNotificationError(t),i.value.value=e.tmpQuantity=e.currentQuantity}.bind(this))}.bind(this),this.DEBOUNCE_TIME)):(s.target.value=e.currentQuantity,e.tmpQuantity=e.currentQuantity)}.bind(this),i.value.onfocus=function(t){this.value=parseFloat(this.value)||""},i.value.onblur=function(t){this.value=this.value||0}},addToBasket:function(t,e,i,s){const a=Math.round(1e6*e);return e=(a-a%Math.round(1e6*i))/1e6,BX.ajax.runAction("sotbit:b2bcabinet.basket.addProductToBasket",{data:{arFields:{PRODUCT_ID:t,QUANTITY:e,PROPS:s}}})},toggleOffers:function(){this.nodeOffers.classList.toggle("hidden")},initSearchOffers:function(){let e="",i=!0,s=t.innerWidth>1200?"table-row":"grid";this.nodeOffers.querySelector("[data-offer-search]").addEventListener("input",(()=>{e=event.target.value.toLowerCase(),i=!0;for(let t in this.offers)e?this.offers[t].name.toLowerCase().includes(e)||this.offers[t].sku?.VALUE.toLowerCase().includes(e)?(this.offers[t].node.style.display=s,i=!1):this.offers[t].node.style.display="none":(this.offers[t].node.style.display=s,i=!1);i?this.nodeEmptyOffer.classList.add("show"):this.nodeEmptyOffer.classList.remove("show")}))},setCurrentOffer:function(){let t=[],e="",i=!1,s={},a=[],n=this.offers[this.offerNum].TREE;for(let r=0;r<this.treeProps.length&&(e="PROP_"+this.treeProps[r].ID,i=this.getRowValues(s,e),i);r++)BX.util.in_array(n[e],i)?s[e]=n[e]:(s[e]=i[0],this.offerNum=0),this.showAbsent?(t=[],a=[],a=BX.clone(s,!0),i.forEach((i=>{a[e]=i,this.getCanBuy(a)&&(t[t.length]=i)}))):t=i,this.updateRow(r,s[e],i,t);this.selectedValues=s,this.changeInfo()},selectOfferProp:function(){let t="",e="",i=[],s=null,a=BX.proxy_context;if(a&&a.hasAttribute("data-treevalue")){if(BX.hasClass(a,"selected")||BX.hasClass(a,"notallowed"))return;if(e=a.getAttribute("data-treevalue"),i=e.split("_"),this.searchOfferPropIndex(i[0],i[1])&&(s=a.parentNode.querySelectorAll("li"),s&&s.length>0))for(let e=0;e<s.length;e++)t=s[e].getAttribute("data-onevalue"),t===i[1]?s[e].classList.add("selected"):s[e].classList.remove("selected")}},searchOfferPropIndex:function(t,e){var i,s,a="",n=!1,r=[],u=[],o=-1,E={},l=[];for(i=0;i<this.treeProps.length;i++)if(this.treeProps[i].ID===t){o=i;break}if(-1<o){for(i=0;i<o;i++)E[a="PROP_"+this.treeProps[i].ID]=this.selectedValues[a];if(a="PROP_"+this.treeProps[o].ID,!(n=this.getRowValues(E,a)))return!1;if(!BX.util.in_array(e,n))return!1;for(E[a]=e,i=o+1;i<this.treeProps.length;i++){if(a="PROP_"+this.treeProps[i].ID,!(n=this.getRowValues(E,a)))return!1;if(u=[],this.showAbsent)for(r=[],l=[],l=BX.clone(E,!0),s=0;s<n.length;s++)l[a]=n[s],u[u.length]=n[s],this.getCanBuy(l)&&(r[r.length]=n[s]);else r=n;this.selectedValues[a]&&BX.util.in_array(this.selectedValues[a],r)?E[a]=this.selectedValues[a]:this.showAbsent?E[a]=r.length>0?r[0]:u[0]:E[a]=r[0],this.updateRow(i,E[a],n,r)}this.selectedValues=E,this.changeInfo()}return!0},getRowValues:function(t,e){let i=[],s=!1,a=!0;if(0===Object.keys(t).length){for(let t in this.offers)BX.util.in_array(this.offers[t].TREE[e],i)||(i[i.length]=this.offers[t].TREE[e]);s=!0}else for(let n in this.offers){a=!0;for(let e in t)if(t[e]!==this.offers[n].TREE[e]){a=!1;break}a&&(BX.util.in_array(this.offers[n].TREE[e],i)||(i[i.length]=this.offers[n].TREE[e]),s=!0)}return!!s&&i},getCanBuy:function(t){let e=!1,i=!0;for(let s in this.offers){i=!0;for(let e in t)if(t[e]!==this.offers[s].TREE[e]){i=!1;break}if(i&&this.offers[s].CAN_BUY){e=!0;break}}return e},getOfferQuantityPropsById:function(t){const e=this.arResult.ITEM.OFFERS;if(!Array.isArray(e))return{nodes:null,currentQuantity:null,tmpQuantity:null,maxQuantity:null,minQuantity:null};const i=this.offers[t],s=this.arResult.ITEM_IDS.OFFERS[t],a={wrapper:document.getElementById(s.QUANTITY),increment:document.getElementById(s.QUANTITY_INCREMENT),value:document.getElementById(s.QUANTITY_VALUE),decrement:document.getElementById(s.QUANTITY_DECREMENT)};return{itemId:i.id,name:i.name,nodes:a,currentQuantity:i.currentQuantity,tmpQuantity:i.tmpQuantity,maxQuantity:i.maxQuantity,minQuantity:i.minQuantity,measureRatio:i.measureRatio,measureName:i.measureName}},updateRow:function(t,e,i,s){let a="",n=!1,r=null;const u=this.obTree.querySelectorAll('[data-entity="sku-line-block"]');t>-1&&t<u.length&&(r=u[t].querySelectorAll("ul li"),r&&r.length>0&&r.forEach((r=>{a=r.getAttribute("data-onevalue"),n=a===e,n?r.classList.add("selected"):r.classList.remove("selected"),BX.util.in_array(a,s)?r.classList.remove("notallowed"):r.classList.add("notallowed"),r.style.display=BX.util.in_array(a,i)?"":"none",n&&(u[t].style.display=0==a&&1==s.length?"none":"")})))},changeInfo:function(){let t=-1,e=!0;for(let i in this.offers){e=!0;for(let t in this.selectedValues)if(this.selectedValues[t]!==this.offers[i].TREE[t]){e=!1;break}if(e){t=i;break}}if(t>-1){if(this.nodePict&&this.offers[t].PREVIEW_PICTURE?this.nodePict.setAttribute("src",this.offers[t].PREVIEW_PICTURE.SRC):this.nodePict.setAttribute("src",this.defaultPict.pict.SRC),this.showSkuProps&&this.offers[t].sku){const e=this.node.querySelector(".product__artnumber");this.offers[t].sku.VALUE&&this.offers[t].sku.VALUE.length>20?(e.setAttribute("title",this.offers[t].DISPLAY_PROPERTIES),e.innerHTML=this.offers[t].sku.NAME+": "+this.offers[t].sku.VALUE.substr(0,20)+"..."):this.offers[t].sku.VALUE?e.innerHTML=this.offers[t].sku.NAME+": "+this.offers[t].sku.VALUE:e.innerHTML=""}this.offerNum=t,this.setQuantity(t),this.setPrice(t),this.setAvaliable(t),this.setPicture(t),this.setName(t)}},setQuantity:function(t){let e=this.offers[t];0===this.errorCode&&(this.canBuy=e.CAN_BUY,this.canBuy&&(this.blockNodes.quantity&&(this.blockNodes.quantity.style.display=""),BX.onCustomEvent(e.obQuantity,"UpdateQuantity",{id:e.id,quantity:e.obQuantity.currentQuantity}),"LIST"!==this.arParams.OFFERS_VIEW&&BX.onCustomEvent(this.obQuantity,"UpdateQuantity",{id:e.id,name:e.name,quantity:e.obQuantity.currentQuantity,maxQuantity:e.maxQuantity,minQuantity:e.minQuantity,measureName:e.measureName,measureRatio:e.measureRatio})))},setPrice:function(t){const e=this.offers[t].PRINT_PRICES;let i;this.nodePrices.forEach((s=>{e[s.dataset.code]&&e[s.dataset.code][this.offers[t].ITEM_QUANTITY_RANGE_SELECTED]?(i=e[s.dataset.code][this.offers[t].ITEM_QUANTITY_RANGE_SELECTED],s.querySelector(".product__price-value").innerHTML=i.PRINT,i.DISCOUNT_PRICE&&Math.round(i.DISCOUNT_PRICE??0,2)!==Math.round(i.PRICE??0,2)?s.querySelector(".product__property--old-price").innerHTML=i.PRINT_NOT_DISCOUNT_PRICE:s.querySelector(".product__property--old-price").innerHTML=""):(s.querySelector(".product__price-value").innerHTML="",s.querySelector(".product__property--old-price").innerHTML="")})),this.nodePriceMobile.innerHTML=this.offers[t].MIN_PRICE.PRINT},setAvaliable:function(e){if(!this.nodeAvaliable)return;let i=0,s="";"M"===this.arParams.SHOW_MAX_QUANTITY?this.offers[e].CATALOG_QUANTITY?(i=+this.offers[e].CATALOG_QUANTITY>+this.arParams.RELATIVE_QUANTITY_FACTOR?this.arParams.MESS_RELATIVE_QUANTITY_MANY:this.arParams.MESS_RELATIVE_QUANTITY_FEW,s=+this.offers[e].CATALOG_QUANTITY>+this.arParams.RELATIVE_QUANTITY_FACTOR?"many":"few"):(i=this.arParams.MESS_NOT_AVAILABLE,s="empty"):i=this.offers[e].CATALOG_QUANTITY,this.nodeAvaliable.querySelector(".item-quantity__general").innerHTML=i,this.nodeAvaliable.querySelector(".title-quant").innerHTML=1!==this.offers[e].measureRatio?this.offers[e].measureRatio:"",this.nodeAvaliable.querySelector(".title-quant").innerHTML+="M"!==this.arParams.SHOW_MAX_QUANTITY?" "+this.offers[e].measureName:"","N"!==this.arParams.SHOW_MAX_QUANTITY&&t["ob_store_item_"+this.offers[e].id]?.setEventAvaliable&&(this.nodeAvaliable.classList.add("show-store"),t["ob_store_item_"+this.offers[e].id].setEventAvaliable(this.nodeAvaliable))},setPicture:function(t){this.nodePict.setAttribute("src",this.offers[t].picture),this.nodePict.setAttribute("srcset",`${this.offers[t].picture} 74w, ${this.offers[t].picture_150} 150w`)},setName:function(t){this.node.querySelector(".product__link").innerHTML=this.offers[t].name},setCurrentQuantityForOffer:function(t){this.offers[this.offerNum].obQuantity.currentQuantity=t.currentQuantity,this.offers[this.offerNum].obQuantity.tmpQuantity=t.currentQuantity},eventUpdateQuantity:function(t){"COMBINED"===this.arParams.OFFERS_VIEW&&(t.isSKU?BX.onCustomEvent(this.offers[this.offerNum].obQuantity,"UpdateQuantity",{id:t.itemId,quantity:t.currentQuantity}):BX.onCustomEvent(this.obQuantity,"UpdateQuantity",{id:t.itemId,quantity:t.currentQuantity}))},showNotificationError:function(t){BX.onCustomEvent("B2BNotification",[t.errors.map((function(t){return t.message})).join("<br>"),"alert"])},showNotificationSuccess:function(t){0===t.currentQuantity?BX.onCustomEvent("B2BNotification",[BX.message("BZI_PRODUCT_NAME")+": "+t.name+"<br>"+BX.message("BZI_PRODUCT_REMOVE_FROM_BASKET"),"success"]):BX.onCustomEvent("B2BNotification",[BX.message("BZI_PRODUCT_NAME")+": "+t.name+"<br>"+BX.message("BZI_PRODUCT_ADD_TO_BASKET")+" "+t.currentQuantity+" "+t.measureName,"success"])},redrawPrices:function(t){if(t.id&&t.count)if(t.id===this.itemId){if(this.arResult.ITEM.ITEM_QUANTITY_RANGES.hasOwnProperty("ZERO-INF"))return;const e=this.arResult.ITEM.ITEM_QUANTITY_RANGES;let i=this.arResult.ITEM.ITEM_QUANTITY_RANGE_SELECTED;for(let s in e)t.count>=(""===e[s].QUANTITY_FROM?Number.NEGATIVE_INFINITY:e[s].QUANTITY_FROM)&&t.count<=(""===e[s].QUANTITY_TO?Number.POSITIVE_INFINITY:e[s].QUANTITY_TO)&&(i=s);for(let t in this.arResult.ITEM_IDS.PRICES){let e=document.getElementById(this.arResult.ITEM_IDS.PRICES[t]);if(e&&"PRIVATE_PRICE"!==t){let s=this.arResult.ITEM.PRINT_PRICES[t];s&&s.hasOwnProperty(i)?e.innerHTML=s[i].PRINT:e.innerHTML=""}}}else{if(!this.arResult.ITEM_IDS.OFFERS?.hasOwnProperty(t.id))return;const e=this.arResult.ITEM.OFFERS[t.id],i=e.ITEM_QUANTITY_RANGES;let s=e.ITEM_QUANTITY_RANGE_SELECTED;for(let e in i)t.count>=(""===i[e].QUANTITY_FROM?Number.NEGATIVE_INFINITY:i[e].QUANTITY_FROM)&&t.count<=(""===i[e].QUANTITY_TO?Number.POSITIVE_INFINITY:i[e].QUANTITY_TO)&&(s=e);for(let e in this.arResult.ITEM_IDS.OFFERS[this.offerNum].PRICES){let i=document.getElementById(this.arResult.ITEM_IDS.OFFERS[this.offerNum].PRICES[e]);if(i&&"PRIVATE_PRICE"!==e){let a=this.arResult.ITEM.OFFERS[t.id].PRINT_PRICES[e];a&&a.hasOwnProperty(s)?i.innerHTML=a[s].PRINT:i.innerHTML=""}}}}})}(window);