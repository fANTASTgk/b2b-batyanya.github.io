!function(t){"use strict";if(!t.JCBlankZakaza){t.JCBlankZakaza=function(e,s){this.arParams=s,this.obName=e,this.node=null,this.wrapper=null,this.formPosting=!1,this.lastLoader=[],BX.ready(BX.delegate((function(){this.init()}),this)),t.addEventListener("load",this.updateScroll.bind(this))},t.JCBlankZakaza.prototype={init:function(){this.node=document.getElementById(this.obName),this.wrapper=document.getElementById(this.obName+"_wrapper"),this.initHeaderSort(),this.initPagination(),this.initScroll(),"Y"===this.arParams.LOAD_ON_SCROLL&&BX.bind(document.querySelector(".content-inner")||document.body,"scroll",BX.proxy(this.loadOnScroll,this))},initPagination:function(){document.querySelectorAll(".pagination").forEach((e=>{e.addEventListener("click",(()=>{event.target.closest(".page-link")&&t.history.pushState(null,null,event.target.href)}))}))},initHeaderSort:function(){function t(t){let s,a="asc";if("QUANTITY"===t.dataset.propertyCode)return;if("OFFERS"===t.dataset.propertyCode)return;s=e[t.dataset.propertyCode]?e[t.dataset.propertyCode]:t.dataset.propertyCode,a=t.dataset.sortOrder===a?"desc":"asc",t.dataset.sortOrder=a,t.classList.add("active"),this.prevNode&&this.prevNode!==t&&(this.prevNode.classList.remove("active"),this.prevNode=t);let o={action:"sort"};o.SORT_BY=s,o.SORT_ORDER=a,BX.showWait(),this.sendRequest(o)}this.node&&this.node.addEventListener("click",function(){event.target.closest("[data-property-code]")&&t.call(this,event.target.closest("[data-property-code]"))}.bind(this))},initChange:function(){if("N"==this.arParams.AJAX_MODE)return;new MutationObserver(this.init.bind(this)).observe(document.getElementById("comp_"+this.arParams.AJAX_ID),{childList:!0})},initScroll:function(){$(this.wrapper).floatingScroll()},updateScroll:function(){$(this.wrapper).floatingScroll("update")},loadOnScroll:function(){let e=document.body.scrollTop,s=BX.pos(this.node).bottom;e+t.innerHeight>s&&this.showMore()},showMore:function(){if(this.arParams.NAV_PARAMS.NavPageNomer<this.arParams.NAV_PARAMS.NavPageCount){var t={action:"showMore"};t["PAGEN_"+this.arParams.NAV_PARAMS.NavNum]=+this.arParams.NAV_PARAMS.NavPageNomer+1,this.formPosting||(this.formPosting=!0,this.showLoader(),this.sendRequest(t))}},sendRequest:function(t){var e={siteId:this.arParams.SITE_ID,template:this.arParams.TEMPLATE,parameters:this.arParams.ORIGINAL_PARAMETERS,sotbit_set_site_template:this.arParams.SITE_TEMPLATE_SIGNS};this.arParams.AJAX_ID&&(e.AJAX_ID=this.arParams.AJAX_ID),BX.ajax({url:this.arParams.AJAX_PATH+(-1!==document.location.href.indexOf("clear_cache=Y")?"?clear_cache=Y":""),method:"POST",dataType:"json",timeout:60,data:BX.merge(e,t),onsuccess:BX.delegate((function(e){e&&e.JS&&(this.showAction(e,t),BX.ajax.processScripts(BX.processHTML(e.JS).SCRIPT))}),this)})},showAction:function(t,e){if(e)switch(e.action){case"showMore":this.processShowMoreAction(t);break;case"deferredLoad":this.processDeferredLoadAction(t);break;case"sort":this.processSortAction(t);break}},processShowMoreAction:function(t){this.formPosting=!1,this.closeLoader(),t&&(this.arParams.NAV_PARAMS.NavPageNomer++,this.processItems(t.items),this.processEpilogue(t.epilogue))},processDeferredLoadAction:function(t){t&&this.processItems(t.items)},processSortAction:function(t){BX.closeWait(),t&&(this.arParams.NAV_PARAMS.NavPageNomer=1,this.node.querySelectorAll("tbody").forEach((t=>t.remove())),this.processItems(t.items),this.processEpilogue(t.epilogue))},processItems:function(t){if(!t)return;let e=BX.processHTML(t,!1),s=BX.create("template");s.innerHTML=e.HTML,this.node.appendChild(s.content),BX.ajax.processScripts(e.SCRIPT)},processEpilogue:function(t){if(t){var e=BX.processHTML(t,!1);BX.ajax.processScripts(e.SCRIPT)}},changeNumPagination:function(){document.querySelector(".current-page").innerText=this.arParams.NAV_PARAMS.NavPageNomer},showLoader:function(){let t=Math.random(),e=BX.create("DIV",{props:{id:"loader_"+t},style:{zIndex:"10000",position:"absolute",bottom:"1.5rem",left:"calc(50% - 1.5rem)"}}),s=document.createElement("div"),a=document.createElement("div");s.setAttribute("class","theme_xbox"),a.setAttribute("class","pace_activity"),s.appendChild(a),e.appendChild(s),this.lastLoader.push(this.node.appendChild(e))},closeLoader:function(){let t=this.lastLoader.pop();t.parentNode.removeChild(t)}};var e={NAME:"NAME",AVALIABLE:"QUANTITY",MEASURE:"MEASURE"}}}(window);