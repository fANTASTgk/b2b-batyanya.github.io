!function(e){"use strict";if(!e.JCBlankZakaza){e.JCBlankZakaza=function(t,a){this.arParams=a,this.obName=t,this.parameters=a.PARAMETERS,this.node=null,this.wrapper=null,BX.ready(BX.delegate((function(){this.init()}),this)),e.addEventListener("load",this.updateScroll.bind(this)),e.addEventListener("popstate",(function(e){location.reload()}))},e.JCBlankZakaza.prototype={init:function(){this.node=document.getElementById(this.obName),this.wrapper=document.getElementById(this.obName+"_wrapper"),this.initHeaderSort(),this.initFullScreen(),this.initPagination(),this.initScroll(),this.initDetailLink()},initFullScreen:function(){this.wrapper.querySelector('a[data-action="fullscreen"]')?.addEventListener("click",this.clickFullScreen.bind(this))},initPagination:function(){document.querySelectorAll(".pagination").forEach((e=>{e.parentNode.addEventListener("click",(e=>{if(!e.target.closest(".page-link"))return;e.preventDefault();let t={},a=new URL(e.target.href);t.action="pagination",a.searchParams.get("SORT[CODE]")&&a.searchParams.get("SORT[ORDER]")&&(t.SORT_BY=a.searchParams.get("SORT[CODE]"),t.SORT_ORDER=a.searchParams.get("SORT[ORDER]")),t["PAGEN_"+this.arParams.NAV_PARAMS.NavNum]=a.searchParams.get("PAGEN_"+this.arParams.NAV_PARAMS.NavNum),t["SIZEN_"+this.arParams.NAV_PARAMS.NavNum]=a.searchParams.get("SIZEN_"+this.arParams.NAV_PARAMS.NavNum),t.url=a,BX.showWait(),this.sendRequest(t)}))}))},clickFullScreen:function(){event.stopPropagation();const e=event.target.closest(".catalog__section-wrapper"),t="card-fullscreen",a=e.classList.contains(t)?"init":"destroy";e.classList.toggle(t),e.classList.toggle("m-0"),e.classList.toggle("h-100"),e.querySelector(".catalog__search").classList.toggle("d-none"),$(this.wrapper).floatingScroll(a)},initHeaderSort:function(){this.node&&this.node.addEventListener("click",function(){event.target.closest("[data-property-code]")&&this.changeSortHeader(event.target.closest("[data-property-code]"))}.bind(this))},initSidePanelDetailPage:function(){"Y"!==this.arParams.AJAX_MODE&&BX.loadExt("sidepanel").then(function(){BX.SidePanel.Instance.bindAnchors({rules:[{condition:[new RegExp(location.pathname+"?\\S*"+this.arParams.ELEMENT_ID_VARIABLE+"=[0-9]+","i"),new RegExp(location.pathname+"?\\S*([\\.\\-0-9a-zA-Z]+)(/?)([^/]*)","i")],stopParameters:["PAGEN_(\\d+)"],options:{width:1344,label:{text:"",color:"#FFFFFF",bgColor:"#3e495f",opacity:80}}}],handler:function(e,t){e.preventDefault(),BX.SidePanel.Instance.open(t,{})}})}.bind(this))},initScroll:function(){$(this.wrapper).floatingScroll()},updateScroll:function(){$(this.wrapper).floatingScroll("update")},initDetailLink:function(){this.wrapper.addEventListener("click",(function(e){let t=null;(t=e.target.closest(".product__link"))&&(e.preventDefault(),BX.SidePanel.Instance.open(t.dataset.href,{width:1344,label:{text:"",color:"#9E9E9E",bgColor:"transparent",opacity:80}}))}))},sendRequest:function(t){var a={siteId:this.arParams.SITE_ID,template:this.arParams.TEMPLATE,parameters:this.parameters,sotbit_set_site_template:this.arParams.SITE_TEMPLATE_SIGNS};this.arParams.AJAX_ID&&(a.AJAX_ID=this.arParams.AJAX_ID),BX.ajax({url:this.arParams.AJAX_PATH+(-1!==document.location.href.indexOf("clear_cache=Y")?"?clear_cache=Y":""),method:"POST",dataType:"json",timeout:120,data:BX.merge(a,t),onsuccess:BX.delegate((function(a){BX.closeWait(),a&&a.JS&&(this.showAction(a,t),BX.ajax.processScripts(BX.processHTML(a.JS).SCRIPT),e.history.pushState({urlPath:t.url.href},null,t.url.href))}),this)})},showAction:function(e,t){if(t.action)switch(t.action){case"sort":this.processUpdate(e,t);break;case"pagination":this.processUpdate(e,t),$(".fl-scrolls").floatingScroll("update");break}},processUpdate:function(e,t){e&&(this.node.querySelectorAll("tbody").forEach((e=>e.remove())),this.processTableHeader(e.tableHeader),this.processItems(e.items),this.processPagination(e.pagination,t),this.processEpilogue(e.epilogue),BX.type.isNotEmptyString(e.parameters)&&this.processParameters(e.parameters))},processTableHeader:function(e){if(!e)return;let t=BX.processHTML(e,!1);this.node.querySelector(".blank-zakaza__header").innerHTML=t.HTML,this.initFullScreen(),BX.ajax.processScripts(t.SCRIPT)},processItems:function(e){if(!e)return;let t=BX.processHTML(e,!1),a=BX.create("template");a.innerHTML=t.HTML,this.node.appendChild(a.content),BX.ajax.processScripts(t.SCRIPT)},processPagination:function(e,t){if(!e)return;let a=BX.create("template");a.innerHTML=e,a.content.querySelectorAll(".page-link").forEach((e=>{if(e.href){let a=new URL(e.href);t.SORT_BY&&t.SORT_ORDER&&(a.searchParams.set("SORT[CODE]",t.SORT_BY),a.searchParams.set("SORT[ORDER]",t.SORT_ORDER)),e.setAttribute("href",a.href)}})),document.querySelectorAll(".pagination").forEach((e=>e.parentNode.innerHTML=a.innerHTML))},processEpilogue:function(e){if(e){var t=BX.processHTML(e,!1);BX.ajax.processScripts(t.SCRIPT)}},processParameters:function(e){this.parameters=e},changeSortHeader:function(e){let a,r="ASC",s={};const i=new URL(location);r=(i.searchParams.get("SORT[ORDER]")||r)===r?"DESC":"ASC","QUANTITY"!==e.dataset.propertyCode&&"OFFERS"!==e.dataset.propertyCode&&(a=t[e.dataset.propertyCode]?t[e.dataset.propertyCode]:e.dataset.propertyCode,e.dataset.sortOrder=r,this.prevNode?this.prevNode!==e&&this.prevNode.classList.remove("active"):this.wrapper.querySelectorAll(".blank-zakaza__header-property").forEach((e=>e.classList.remove("active"))),e.classList.add("active"),this.prevNode=e,i.searchParams.set("SORT[CODE]",a),i.searchParams.set("SORT[ORDER]",r),s.url=i,s.action="sort",s.SORT_BY=a,s.SORT_ORDER=r,s["PAGEN_"+this.arParams.NAV_PARAMS.NavNum]=i.searchParams.get("PAGEN_"+this.arParams.NAV_PARAMS.NavNum),s["SIZEN_"+this.arParams.NAV_PARAMS.NavNum]=i.searchParams.get("SIZEN_"+this.arParams.NAV_PARAMS.NavNum),BX.showWait(),this.sendRequest(s))}};var t={NAME:"NAME",AVALIABLE:"QUANTITY",MEASURE:"MEASURE"}}}(window);