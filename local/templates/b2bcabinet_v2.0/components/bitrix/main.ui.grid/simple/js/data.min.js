!function(){"use strict";BX.namespace("BX.Grid");var t=window.parent.BX.ajax.UpdatePageData;BX.Grid.Data=function(t){this.parent=t,this.reset()},BX.Grid.Data.prototype.reset=function(){this.response=null,this.xhr=null,this.headRows=null,this.bodyRows=null,this.footRows=null,this.moreButton=null,this.pagination=null,this.counterDisplayed=null,this.counterSelected=null,this.counterTotal=null,this.limit=null,this.actionPanel=null,this.rowsByParentId={},this.rowById={},this.isValidResponse=null},BX.Grid.Data.prototype.getParent=function(){return this.parent},BX.Grid.Data.prototype.validateResponse=function(){return BX.type.isBoolean(this.isValidResponse)||(this.isValidResponse=!!this.getResponse()&&!!BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classContainer"),!0)),this.isValidResponse},BX.Grid.Data.prototype.request=function(e,s,i,a,n,r){BX.type.isString(e)||(e=""),BX.type.isNotEmptyString(s)||(s="GET"),BX.type.isPlainObject(i)||(i={});var o={gridId:this.parent.getId(),url:e,method:s,data:i};if(this.parent.disableCheckAllCheckboxes(),BX.onCustomEvent(window,"Grid::beforeRequest",[this,o]),!o.hasOwnProperty("cancelRequest")||!0!==o.cancelRequest){e=o.url,BX.type.isNotEmptyString(e)||(e=this.parent.baseUrl),e=BX.Grid.Utils.addUrlParams(e,{sessid:BX.bitrix_sessid(),internal:"true",grid_id:this.parent.getId()}),e="apply_filter"in i&&"Y"===i.apply_filter?BX.Grid.Utils.addUrlParams(e,{apply_filter:"Y"}):BX.util.remove_url_param(e,"apply_filter"),e="clear_nav"in i&&"Y"===i.clear_nav?BX.Grid.Utils.addUrlParams(e,{clear_nav:"Y"}):BX.util.remove_url_param(e,"clear_nav"),e=BX.Grid.Utils.addUrlParams(e,{grid_action:a||"showpage"}),s=o.method,i=o.data,this.reset();var l=this;setTimeout((function(){var o=BX.Http.Data.convertObjectToFormData(i);window.parent.BX.ajax.UpdatePageData=function(){};var d=BX.ajax({url:BX.Grid.Utils.ajaxUrl(e,l.getParent().getAjaxId()),data:o,method:s,dataType:"html",headers:[{name:"X-Ajax-Grid-UID",value:l.getParent().getAjaxId()},{name:"X-Ajax-Grid-Req",value:JSON.stringify({action:a||"showpage"})}],processData:!0,scriptsRunFirst:!1,start:!1,preparePost:!1,onsuccess:function(e){if(l.response=BX.create("div",{html:e}),l.response=l.response.querySelector("#"+l.parent.getContainerId()),l.xhr=d,l.parent.getParam("HANDLE_RESPONSE_ERRORS")){var s;try{s=JSON.parse(e)}catch(t){s={messages:[]}}if(s.messages.length)return l.parent.arParams.MESSAGES=s.messages,l.parent.messages.show(),l.parent.tableUnfade(),void(BX.type.isFunction(r)&&BX.delegate(r,l)(d))}BX.type.isFunction(n)&&(l.parent.enableCheckAllCheckboxes(),BX.delegate(n,l)(e,d)),window.parent.BX.ajax.UpdatePageData=t},onerror:function(t){l.error=r,l.xhr=d,BX.type.isFunction(r)&&(l.parent.enableCheckAllCheckboxes(),BX.delegate(r,l)(d,t))}});d.send(o)}),0)}},BX.Grid.Data.prototype.getResponse=function(){return this.response},BX.Grid.Data.prototype.getContainer=function(){const t=this.getParent().settings.get("classContainer");return BX.Dom.hasClass(this.getResponse(),t)?this.getResponse():BX.Grid.Utils.getByClass(this.getResponse(),t,!0)},BX.Grid.Data.prototype.getHeadRows=function(){return this.headRows||(this.headRows=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classHeadRow"))),this.headRows},BX.Grid.Data.prototype.getBodyRows=function(){return this.bodyRows||(this.bodyRows=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classBodyRow"))),this.bodyRows},BX.Grid.Data.prototype.getRowsByParentId=function(t){return t in this.rowsByParentId||(this.rowsByParentId[t]=BX.Grid.Utils.getBySelector(this.getResponse(),"."+this.getParent().settings.get("classBodyRow")+'[data-parent-id="'+t+'"]')),this.rowsByParentId[t]},BX.Grid.Data.prototype.getRowById=function(t){return t in this.rowById||(this.rowById[t]=BX.Grid.Utils.getBySelector(this.getResponse(),"."+this.getParent().settings.get("classBodyRow")+'[data-id="'+t+'"]',!0)),this.rowById[t]},BX.Grid.Data.prototype.getFootRows=function(){return this.footRows||(this.footRows=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classFootRow"))),this.footRows},BX.Grid.Data.prototype.getMoreButton=function(){return this.moreButton||(this.moreButton=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classMoreButton"),!0)),this.moreButton},BX.Grid.Data.prototype.getPagination=function(){return this.pagination||(this.pagination=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classPagination"),!0),BX.type.isDomNode(this.pagination)&&(this.pagination=BX.firstChild(this.pagination))),this.pagination},BX.Grid.Data.prototype.getCounterDisplayed=function(){return this.counterDisplayed||(this.counterDisplayed=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classCounterDisplayed"),!0)),this.counterDisplayed},BX.Grid.Data.prototype.getCounterSelected=function(){return this.counterSelected||(this.counterSelected=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classCounterSelected"),!0)),this.counterSelected},BX.Grid.Data.prototype.getCounterTotal=function(){if(!BX.type.isDomNode(this.counterTotal)){var t="."+this.getParent().settings.get("classCounterTotal")+" ."+this.getParent().settings.get("classPanelCellContent");this.counterTotal=BX.Grid.Utils.getBySelector(this.getResponse(),t,!0)}return this.counterTotal},BX.Grid.Data.prototype.getLimit=function(){return this.limit||(this.limit=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classPageSize"),!0)),this.limit},BX.Grid.Data.prototype.getPageSize=function(){return this.getLimit()},BX.Grid.Data.prototype.getActionPanel=function(){return this.actionPanel||(this.actionPanel=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classActionPanel"),!0)),this.actionPanel}}();