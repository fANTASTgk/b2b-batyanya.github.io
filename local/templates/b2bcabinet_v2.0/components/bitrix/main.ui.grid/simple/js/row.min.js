(function(){"use strict";BX.namespace("BX.Grid"),BX.Grid.Row=function(t,e){this.node=null,this.checkbox=null,this.sort=null,this.actions=null,this.settings=null,this.index=null,this.actionsButton=null,this.parent=null,this.depth=null,this.parentId=null,this.editData=null,this.custom=null,this.init(t,e)},BX.Grid.Row.prototype={init:function(t,e){BX.type.isDomNode(e)&&(this.node=e,this.parent=t,this.settings=new BX.Grid.Settings,this.bindNodes=[],this.isBodyChild()&&(this.bindNodes=[].slice.call(this.node.parentNode.querySelectorAll('tr[data-bind="'+this.getId()+'"]')),this.bindNodes.length&&(this.node.addEventListener("mouseover",this.onMouseOver.bind(this)),this.node.addEventListener("mouseleave",this.onMouseLeave.bind(this)),this.bindNodes.forEach((function(t){t.addEventListener("mouseover",this.onMouseOver.bind(this)),t.addEventListener("mouseleave",this.onMouseLeave.bind(this)),t.addEventListener("click",function(){this.isSelected()?this.unselect():this.select()}.bind(this))}),this))),this.parent.getParam("ALLOW_CONTEXT_MENU")&&BX.bind(this.getNode(),"contextmenu",BX.delegate(this._onRightClick,this)))},onMouseOver:function(){this.node.classList.add("main-grid-row-over"),this.bindNodes.forEach((function(t){t.classList.add("main-grid-row-over")}))},onMouseLeave:function(){this.node.classList.remove("main-grid-row-over"),this.bindNodes.forEach((function(t){t.classList.remove("main-grid-row-over")}))},isCustom:function(){return null===this.custom&&(this.custom=BX.hasClass(this.getNode(),this.parent.settings.get("classRowCustom"))),this.custom},_onRightClick:function(t){t.preventDefault(),this.isHeadChild()||this.showActionsMenu(t)},getDefaultAction:function(){return BX.data(this.getNode(),"default-action")},getEditorValue:function(){var t,e=this,n=this.getCells(),i={};return[].forEach.call(n,(function(n){t=e.getCellEditorValue(n),BX.type.isArray(t)?t.forEach((function(t){i[t.NAME]=void 0!==t.VALUE?t.VALUE:"",t.hasOwnProperty("RAW_NAME")&&t.hasOwnProperty("RAW_VALUE")&&(i[t.NAME+"_custom"]=i[t.NAME+"_custom"]||{},i[t.NAME+"_custom"][t.RAW_NAME]=i[t.NAME+"_custom"][t.RAW_NAME]||t.RAW_VALUE)})):t&&(i[t.NAME]=void 0!==t.VALUE?t.VALUE:"")})),i},editGetValues:function(){return this.getEditorValue()},getCellEditorValue:function(t){var e=BX.Grid.Utils.getByClass(t,this.parent.settings.get("classEditor"),!0),n=null;return BX.type.isDomNode(e)&&(n=BX.hasClass(e,"main-grid-editor-checkbox")?{NAME:e.getAttribute("name"),VALUE:e.checked?"Y":"N"}:BX.hasClass(e,"main-grid-editor-custom")?this.getCustomValue(e):BX.hasClass(e,"main-grid-editor-money")?this.getMoneyValue(e):BX.hasClass(e,"main-ui-multi-select")?this.getMultiSelectValues(e):this.getImageValue(e)),n},isEdit:function(){return BX.hasClass(this.getNode(),"main-grid-row-edit")},hide:function(){BX.addClass(this.getNode(),this.parent.settings.get("classHide"))},show:function(){BX.Dom.attr(this.getNode(),"hidden",null),BX.removeClass(this.getNode(),this.parent.settings.get("classHide"))},isShown:function(){return!BX.hasClass(this.getNode(),this.parent.settings.get("classHide"))},isNotCount:function(){return BX.hasClass(this.getNode(),this.parent.settings.get("classNotCount"))},getContentContainer:function(t){if(BX.Type.isDomNode(t)){var e=t.closest(".main-grid-cell");if(BX.Type.isDomNode(e))return e.querySelector(".main-grid-cell-content")}return t},getContent:function(t){var e,n=this.getContentContainer(t);return BX.type.isDomNode(n)&&(e=BX.html(n)),e},getMoneyValue:function(t){var e=[],n={PRICE:{},CURRENCY:{},HIDDEN:{}},i=t.getAttribute("data-name");[].slice.call(t.querySelectorAll("input")).forEach((function(t){e.push({NAME:i,RAW_NAME:t.name,RAW_VALUE:t.value||"",VALUE:t.value||""}),t.classList.contains("main-grid-editor-money-price")?n.PRICE={NAME:t.name,VALUE:t.value}:" hidden"===t.type&&(n.HIDDEN[t.name]=t.value)}));var s=t.querySelector(".main-grid-editor-dropdown");if(s){var a=s.getAttribute("name");BX.type.isNotEmptyString(a)&&(e.push({NAME:i,RAW_NAME:a,RAW_VALUE:s.dataset.value||"",VALUE:s.dataset.value||""}),n.CURRENCY={NAME:a,VALUE:s.dataset.value})}return e.push({NAME:i,VALUE:n}),e},getCustomValue:function(t){var e=new Map,n=t.getAttribute("data-name");[].slice.call(t.querySelectorAll("input, select, checkbox, textarea")).forEach((function(t){var i={NAME:n,RAW_NAME:t.name,RAW_VALUE:t.value,VALUE:t.value};switch(t.tagName){case"SELECT":if(t.multiple){var s=[];t.querySelectorAll("option").forEach((function(t){t.selected&&s.push(t.value)})),i.RAW_VALUE=s,i.VALUE=s,e.set(t.name,i)}else e.set(t.name,i);break;case"INPUT":switch(t.type.toUpperCase()){case"RADIO":t.checked&&(i.RAW_VALUE=t.value,i.VALUE=t.value,e.set(t.name,i));break;case"CHECKBOX":i.RAW_VALUE=t.checked?t.value:"",i.VALUE=t.checked?t.value:"",e.set(t.name,i);break;case"FILE":i.RAW_VALUE=t.files[0],i.VALUE=t.files[0],e.set(t.name,i);break;default:e.set(t.name,i)}break;default:e.set(t.name,i)}}));var i=[];return e.forEach((function(t){i.push(t)})),i},getImageValue:function(t){var e=null;if(BX.hasClass(t,"main-grid-image-editor")){var n=t.querySelector(".main-grid-image-editor-file-input");if(n)e={NAME:n.name,VALUE:n.files[0]};else{var i=t.querySelector(".main-grid-image-editor-fake-file-input");i&&(e={NAME:i.name,VALUE:i.value})}}else e=t.value?{NAME:t.getAttribute("name"),VALUE:t.value}:{NAME:t.getAttribute("name"),VALUE:BX.data(t,"value")};return e},getMultiSelectValues:function(t){var e=JSON.parse(BX.data(t,"value"));return{NAME:t.getAttribute("name"),VALUE:main_core.Type.isArrayFilled(e)?e:""}},getEditorContainer:function(t){return BX.Grid.Utils.getByClass(t,this.parent.settings.get("classEditorContainer"),!0)},getCollapseButton:function(){return this.collapseButton||(this.collapseButton=BX.Grid.Utils.getByClass(this.getNode(),this.parent.settings.get("classCollapseButton"),!0)),this.collapseButton},stateLoad:function(){BX.addClass(this.getNode(),this.parent.settings.get("classRowStateLoad"))},stateUnload:function(){BX.removeClass(this.getNode(),this.parent.settings.get("classRowStateLoad"))},stateExpand:function(){BX.addClass(this.getNode(),this.parent.settings.get("classRowStateExpand"))},stateCollapse:function(){BX.removeClass(this.getNode(),this.parent.settings.get("classRowStateExpand"))},getParentId:function(){return null===this.parentId&&(this.parentId=BX.data(this.getNode(),"parent-id"),void 0!==this.parentId&&null!==this.parentId&&(this.parentId=this.parentId.toString())),this.parentId},getDataset:function(){return this.getNode().dataset},getDepth:function(){return null===this.depth&&(this.depth=BX.data(this.getNode(),"depth")),this.depth},setDepth:function(t){if(t=parseInt(t),BX.type.isNumber(t)){var e=t-parseInt(this.getDepth()),n=this.parent.getRows();this.getDataset().depth=t,this.getShiftCells().forEach((function(e){BX.data(e,"depth",t),BX.style(e,"padding-left",20*t+"px")}),this),n.getRowsByParentId(this.getId(),!0).forEach((function(t){var n=parseInt(e)+parseInt(t.getDepth());t.getDataset().depth=n,t.getShiftCells().forEach((function(t){BX.data(t,"depth",n),BX.style(t,"padding-left",20*n+"px")}))}))}},setParentId:function(t){this.getDataset().parentId=t},getShiftCells:function(){return BX.Grid.Utils.getBySelector(this.getNode(),'td[data-shift="true"]')},showChildRows:function(){var t=this.getChildren(),e=this.isCustom();t.forEach((function(t){t.show(),!e&&t.isExpand()&&t.showChildRows()})),this.parent.updateCounterDisplayed(),this.parent.updateCounterSelected(),this.parent.adjustCheckAllCheckboxes(),this.parent.adjustRows()},getChildren:function(){var t=this.isCustom()?"getRowsByGroupId":"getRowsByParentId",e=this.isCustom()?this.getGroupId():this.getId();return this.parent.getRows()[t](e,!0)},hideChildRows:function(){this.getChildren().forEach((function(t){t.hide()})),this.parent.updateCounterDisplayed(),this.parent.updateCounterSelected(),this.parent.adjustCheckAllCheckboxes(),this.parent.adjustRows()},isChildsLoaded:function(){return BX.type.isBoolean(this.childsLoaded)||(this.childsLoaded=this.isCustom()||"true"===BX.data(this.getNode(),"child-loaded")),this.childsLoaded},expand:function(){var t=this;this.stateExpand(),this.isChildsLoaded()?this.showChildRows():(this.stateLoad(),this.loadChildRows((function(e){e.reverse().forEach((function(e){BX.insertAfter(e,t.getNode())})),t.parent.getRows().reset(),t.parent.bindOnRowEvents(),t.parent.getParam("ALLOW_ROWS_SORT")&&t.parent.getRowsSortable().reinit(),t.parent.getParam("ALLOW_COLUMNS_SORT")&&t.parent.getColsSortable().reinit(),t.stateUnload(),BX.data(t.getNode(),"child-loaded","true"),t.parent.updateCounterDisplayed(),t.parent.updateCounterSelected(),t.parent.adjustCheckAllCheckboxes()})))},collapse:function(){this.stateCollapse(),this.hideChildRows()},isExpand:function(){return BX.hasClass(this.getNode(),this.parent.settings.get("classRowStateExpand"))},toggleChildRows:function(){this.isExpand()?this.collapse():this.expand()},loadChildRows:function(t){if(BX.type.isFunction(t)){var e=this,n=parseInt(this.getDepth()),i=this.parent.getUserOptions().getAction("GRID_GET_CHILD_ROWS");n=BX.type.isNumber(n)?n+1:1,this.parent.getData().request("","POST",{action:i,parent_id:this.getId(),depth:n},null,(function(){var n=this.getRowsByParentId(e.getId());t.apply(null,[n])}))}},update:function(t,e,n){t=t||"";var i=this.parent.getUserOptions().getAction("GRID_UPDATE_ROW"),s=this.getDepth(),a=this.getId(),o=this.getParentId(),r={id:a,parentId:o,action:i,depth:s,data:t},l=this;this.stateLoad(),this.parent.getData().request(e,"POST",r,null,(function(){var e=this.getBodyRows();l.parent.getUpdater().updateBodyRows(e),l.stateUnload(),l.parent.getRows().reset(),l.parent.getUpdater().updateFootRows(this.getFootRows()),l.parent.getUpdater().updatePagination(this.getPagination()),l.parent.getUpdater().updateMoreButton(this.getMoreButton()),l.parent.getUpdater().updateCounterTotal(this.getCounterTotal()),l.parent.bindOnRowEvents(),l.parent.adjustEmptyTable(e),l.parent.bindOnMoreButtonEvents(),l.parent.bindOnClickPaginationLinks(),l.parent.updateCounterDisplayed(),l.parent.updateCounterSelected(),l.parent.getParam("ALLOW_COLUMNS_SORT")&&l.parent.colsSortable.reinit(),l.parent.getParam("ALLOW_ROWS_SORT")&&l.parent.rowsSortable.reinit(),BX.onCustomEvent(window,"Grid::rowUpdated",[{id:a,data:t,grid:l.parent,response:this}]),BX.onCustomEvent(window,"Grid::updated",[l.parent]),BX.type.isFunction(n)&&n({id:a,data:t,grid:l.parent,response:this})}))},remove:function(t,e,n){t=t||"";var i=this.parent.getUserOptions().getAction("GRID_DELETE_ROW"),s=this.getDepth(),a=this.getId(),o=this.getParentId(),r={id:a,parentId:o,action:i,depth:s,data:t},l=this;this.stateLoad(),this.parent.getData().request(e,"POST",r,null,(function(){var e=this.getBodyRows();l.parent.getUpdater().updateBodyRows(e),l.stateUnload(),l.parent.getRows().reset(),l.parent.getUpdater().updateFootRows(this.getFootRows()),l.parent.getUpdater().updatePagination(this.getPagination()),l.parent.getUpdater().updateMoreButton(this.getMoreButton()),l.parent.getUpdater().updateCounterTotal(this.getCounterTotal()),l.parent.bindOnRowEvents(),l.parent.adjustEmptyTable(e),l.parent.bindOnMoreButtonEvents(),l.parent.bindOnClickPaginationLinks(),l.parent.updateCounterDisplayed(),l.parent.updateCounterSelected(),l.parent.getParam("ALLOW_COLUMNS_SORT")&&l.parent.colsSortable.reinit(),l.parent.getParam("ALLOW_ROWS_SORT")&&l.parent.rowsSortable.reinit(),BX.onCustomEvent(window,"Grid::rowRemoved",[{id:a,data:t,grid:l.parent,response:this}]),BX.onCustomEvent(window,"Grid::updated",[l.parent]),BX.type.isFunction(n)&&n({id:a,data:t,grid:l.parent,response:this})}))},editCancel:function(){var t,e=this.getCells(),n=this;[].forEach.call(e,(function(e){t=n.getEditorContainer(e),BX.type.isDomNode(t)&&(BX.remove(n.getEditorContainer(e)),BX.show(n.getContentContainer(e)))})),BX.removeClass(this.getNode(),"main-grid-row-edit")},getCellByIndex:function(t){return this.getCells()[t]},getEditDataByCellIndex:function getEditDataByCellIndex(index){return eval(BX.data(this.getCellByIndex(index),"edit"))},getCellNameByCellIndex:function(t){return BX.data(this.getCellByIndex(t),"name")},resetEditData:function(){this.editData=null},setEditData:function(t){this.editData=t},getEditData:function(){if(null===this.editData){var t=this.parent.getParam("EDITABLE_DATA"),e=this.getId();BX.type.isPlainObject(t)&&e in t?this.editData=t[e]:this.editData={}}return this.editData},getCellEditDataByCellIndex:function(t){var e=this.getEditData(),n=null;if(t=parseInt(t),BX.type.isNumber(t)&&BX.type.isPlainObject(e)){var i=this.parent.getRows().getHeadFirstChild().getEditDataByCellIndex(t);BX.type.isPlainObject(i)&&((n=i).VALUE=e[i.NAME])}return n},edit:function(){var t,e,n,i,s=this.getCells(),a=this;[].forEach.call(s,(function(s,o){if("true"===s.dataset.editable){try{t=a.getCellEditDataByCellIndex(o)}catch(t){throw new Error(t)}a.parent.getEditor().validateEditObject(t)&&(i=a.getContentContainer(s),n=BX.height(i),e=a.parent.getEditor().getEditor(t,n),!a.getEditorContainer(s)&&BX.type.isDomNode(e)&&(s.appendChild(e),BX.hide(i)))}})),BX.addClass(this.getNode(),"main-grid-row-edit")},setDraggable:function(t){t?(BX.removeClass(this.getNode(),this.parent.settings.get("classDisableDrag")),this.parent.getRowsSortable().register(this.getNode())):(BX.addClass(this.getNode(),this.parent.settings.get("classDisableDrag")),this.parent.getRowsSortable().unregister(this.getNode()))},isDraggable:function(){return!BX.hasClass(this.getNode(),this.parent.settings.get("classDisableDrag"))},getNode:function(){return this.node},getIndex:function(){return this.getNode().rowIndex},getId:function(){return String(BX.data(this.getNode(),"id"))},getGroupId:function(){return BX.data(this.getNode(),"group-id").toString()},getObserver:function(){return BX.Grid.observer},getCheckbox:function(){return this.checkbox||(this.checkbox=BX.Grid.Utils.getByClass(this.getNode(),this.settings.get("classRowCheckbox"),!0)),this.checkbox},getActionsMenu:function(){if(!this.actionsMenu){var t=this.getActionsButton().getBoundingClientRect();this.actionsMenu=BX.PopupMenu.create("main-grid-actions-menu-"+this.getId(),this.getActionsButton(),this.getMenuItems(),{autoHide:!0,offsetTop:-(t.height/2+26),offsetLeft:30,angle:{position:"left",offset:t.height/2-8},events:{onPopupClose:BX.delegate(this._onCloseMenu,this),onPopupShow:BX.delegate(this._onPopupShow,this)}}),BX.addCustomEvent("Grid::updated",function(){this.actionsMenu&&(this.actionsMenu.destroy(),this.actionsMenu=null)}.bind(this)),BX.bind(this.actionsMenu.popupWindow.popupContainer,"click",BX.delegate((function(t){var e=this.getActionsMenu();if(e){var n=BX.getEventTarget(t),i=BX.findParent(n,{className:"menu-popup-item"},10);i&&i.dataset.preventCloseContextMenu||e.close()}}),this))}return this.actionsMenu},_onCloseMenu:function(){},_onPopupShow:function(t){t.setBindElement(this.getActionsButton())},actionsMenuIsShown:function(){return this.getActionsMenu().popupWindow.isShown()},showActionsMenu:function(t){BX.fireEvent(document.body,"click"),this.getActionsMenu().popupWindow.show(),t&&(this.getActionsMenu().popupWindow.popupContainer.style.top=t.pageY-25+BX.PopupWindow.getOption("offsetTop")+"px",this.getActionsMenu().popupWindow.popupContainer.style.left=t.pageX+20+BX.PopupWindow.getOption("offsetLeft")+"px")},closeActionsMenu:function(){this.actionsMenu&&this.actionsMenu.popupWindow&&this.actionsMenu.popupWindow.close()},getMenuItems:function(){return this.getActions()||[]},getActions:function getActions(){try{this.actions=this.actions||eval(BX.data(this.getActionsButton(),this.settings.get("dataActionsKey")))}catch(t){this.actions=null}return this.actions},getActionsButton:function(){return this.actionsButton||(this.actionsButton=BX.Grid.Utils.getByClass(this.getNode(),this.settings.get("classRowActionButton"),!0)),this.actionsButton},initSelect:function(){this.isSelected()&&!BX.hasClass(this.getNode(),this.settings.get("classCheckedRow"))&&BX.addClass(this.getNode(),this.settings.get("classCheckedRow"))},getParentNode:function(){var t;try{t=this.getNode().parentNode}catch(e){t=null}return t},getParentNodeName:function(){var t;try{t=this.getParentNode().nodeName}catch(e){t=null}return t},isSelectable:function(){return!this.isEdit()||this.parent.getParam("ALLOW_EDIT_SELECTION")},select:function(){var t;!this.isSelectable()||!this.parent.getParam("ADVANCED_EDIT_MODE")&&this.parent.getRows().hasEditable()||(t=this.getCheckbox())&&(BX.data(t,"disabled")||(BX.addClass(this.getNode(),this.settings.get("classCheckedRow")),this.bindNodes.forEach((function(t){BX.addClass(t,this.settings.get("classCheckedRow"))}),this),t.checked=!0))},unselect:function(){this.isSelectable()&&(BX.removeClass(this.getNode(),this.settings.get("classCheckedRow")),this.bindNodes.forEach((function(t){BX.removeClass(t,this.settings.get("classCheckedRow"))}),this),this.getCheckbox()&&(this.getCheckbox().checked=!1))},getCells:function(){return this.getNode().cells},isSelected:function(){return this.getCheckbox()&&this.getCheckbox().checked||BX.hasClass(this.getNode(),this.settings.get("classCheckedRow"))},isHeadChild:function(){return"THEAD"===this.getParentNodeName()&&BX.hasClass(this.getNode(),this.settings.get("classHeadRow"))},isBodyChild:function(){return BX.hasClass(this.getNode(),this.settings.get("classBodyRow"))&&!BX.hasClass(this.getNode(),this.settings.get("classEmptyRows"))},isFootChild:function(){return"TFOOT"===this.getParentNodeName()&&BX.hasClass(this.getNode(),this.settings.get("classFootRow"))},prependTo:function(t){BX.Dom.prepend(this.getNode(),t)},appendTo:function(t){BX.Dom.append(this.getNode(),t)},setId:function(t){BX.Dom.attr(this.getNode(),"data-id",t)},setActions:function(t){var e=this.getNode().querySelector(".main-grid-cell-action");if(e){var n=e.querySelector(".main-grid-row-action-button");if(!n){n=BX.Dom.create({tag:"div",props:{className:"main-grid-row-action-button"}});var i=this.getContentContainer(e);BX.Dom.append(n,i)}BX.Dom.attr(n,{href:"#","data-actions":t}),this.actions=t,this.actionsMenu&&(this.actionsMenu.destroy(),this.actionsMenu=null)}},makeCountable:function(){BX.Dom.removeClass(this.getNode(),"main-grid-not-count")},makeNotCountable:function(){BX.Dom.addClass(this.getNode(),"main-grid-not-count")},getColumnOptions:function(t){var e=this.parent.getParam("COLUMNS_ALL");return BX.Type.isPlainObject(e)&&Reflect.has(e,t)?e[t]:null},setCellsContent:function(t){var e=this,n=this.parent.getRows().getHeadFirstChild();babelHelpers.toConsumableArray(this.getCells()).forEach((function(i,s){var a=n.getCellNameByCellIndex(s);if(Reflect.has(t,a)){var o=e.getColumnOptions(a),r=e.getContentContainer(i),l=t[a];if("labels"===o.type&&BX.Type.isArray(l)){var d=l.map((function(t){var n=BX.Tag.render(_templateObject$1||(_templateObject$1=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t<span class="ui-label ','"></span>\n\t\t\t\t\t\t\t'])),t.color);!0!==t.light&&BX.Dom.addClass(n,"ui-label-fill"),BX.Type.isPlainObject(t.events)&&(Reflect.has(t.events,"click")&&BX.Dom.addClass(n,"ui-label-link"),e.bindOnEvents(n,t.events));var i=BX.Type.isStringFilled(t.html)?t.html:t.text,s=BX.Tag.render(_templateObject2$1||(_templateObject2$1=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t<span class="ui-label-inner">',"</span>\n\t\t\t\t\t\t\t"])),i);if(BX.Dom.append(s,n),BX.Type.isPlainObject(t.removeButton)){var a=t.removeButton.type===BX.Grid.Label.RemoveButtonType.INSIDE?BX.Tag.render(_templateObject3||(_templateObject3=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t\t\t\t<span class="ui-label-icon"></span>\t\n\t\t\t\t\t\t\t\t\t\t']))):BX.Tag.render(_templateObject4||(_templateObject4=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t\t\t<span class="main-grid-label-remove-button ','"></span>\t\n\t\t\t\t\t\t\t\t\t'])),t.removeButton.type);BX.Type.isPlainObject(t.removeButton.events)&&e.bindOnEvents(a,t.removeButton.events),BX.Dom.append(a,n)}return n})),u=BX.Tag.render(_templateObject5||(_templateObject5=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t<div class="main-grid-labels">',"</div>\n\t\t\t\t\t\t"])),d);BX.Dom.clean(r);var c=r.querySelector(".main-grid-labels");BX.Type.isDomNode(c)?BX.Dom.replace(c,u):BX.Dom.append(u,r)}else if("tags"===o.type&&BX.Type.isPlainObject(l)){var h=l.items.map((function(t){var n=BX.Tag.render(_templateObject6||(_templateObject6=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t<span class="main-grid-tag"></span>\n\t\t\t\t\t\t\t'])));e.bindOnEvents(n,t.events),!0===t.active&&BX.Dom.addClass(n,"main-grid-tag-active");var i=BX.Type.isStringFilled(t.html)?t.html:BX.Text.encode(t.text),s=BX.Tag.render(_templateObject7||(_templateObject7=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t<span class="main-grid-tag-inner">',"</span>\n\t\t\t\t\t\t\t"])),i);if(BX.Dom.append(s,n),!0===t.active){var a=BX.Tag.render(_templateObject8||(_templateObject8=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t\t<span class="main-grid-tag-remove"></span>\n\t\t\t\t\t\t\t\t'])));BX.Dom.append(a,n),BX.Type.isPlainObject(t.removeButton)&&e.bindOnEvents(a,t.removeButton.events)}return n})),p=BX.Tag.render(_templateObject9||(_templateObject9=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t<span class="main-grid-tags">',"</span>\n\t\t\t\t\t\t"])),h),g=BX.Tag.render(_templateObject10||(_templateObject10=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t<span class="main-grid-tag-add"></span>\n\t\t\t\t\t\t'])));BX.Type.isPlainObject(l.addButton)&&e.bindOnEvents(g,l.addButton.events),BX.Dom.append(g,p);var m=r.querySelector(".main-grid-tags");BX.Type.isDomNode(m)?BX.Dom.replace(m,p):BX.Dom.append(p,r)}else BX.Runtime.html(r,l)}}))},getCellById:function(t){var e=this.parent.getRows().getHeadFirstChild();return babelHelpers.toConsumableArray(this.getCells()).find((function(n,i){return e.getCellNameByCellIndex(i)===t}))},isTemplate:function(){return this.isBodyChild()&&/^template_[0-9]$/.test(this.getId())},enableAbsolutePosition:function(){var t=babelHelpers.toConsumableArray(this.parent.getRows().getHeadFirstChild().getCells()).map((function(t){return BX.Dom.style(t,"width")})),e=this.getCells();t.forEach((function(t,n){BX.Dom.style(e[n],"width",t)})),BX.Dom.style(this.getNode(),"position","absolute")},disableAbsolutePosition:function(){BX.Dom.style(this.getNode(),"position",null)},getHeight:function(){return BX.Text.toNumber(BX.Dom.style(this.getNode(),"height"))},setCellActions:function(t){var e=this;Object.entries(t).forEach((function(t){var n=babelHelpers.slicedToArray(t,2),i=n[0],s=n[1],a=e.getCellById(i);if(a){var o=a.querySelector(".main-grid-cell-inner");if(o){var r=function(){var t=o.querySelector(".main-grid-cell-content-actions");if(t)return BX.Dom.clean(t),t;var e=BX.Tag.render(_templateObject11||(_templateObject11=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t<div class="main-grid-cell-content-actions"></div>\n\t\t\t\t\t\t\t'])));return BX.Dom.append(e,o),e}();BX.Type.isArrayFilled(s)&&s.forEach((function(t){var n=BX.Type.isArrayFilled(t.class)?t.class.join(" "):t.class,i=BX.Tag.render(_templateObject12||(_templateObject12=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t\t<span class="main-grid-cell-content-action ','"></span>\n\t\t\t\t\t\t\t\t'])),n);BX.Type.isPlainObject(t.events)&&e.bindOnEvents(i,t.events),BX.Type.isPlainObject(t.attributes)&&BX.Dom.attr(i,t.attributes),BX.Dom.append(i,r)}))}}}))},initElementsEvents:function initElementsEvents(){var _this3=this,buttons=babelHelpers.toConsumableArray(this.getNode().querySelectorAll(".main-grid-cell [data-events]"));BX.Type.isArrayFilled(buttons)&&buttons.forEach((function(button){var events=eval(BX.Dom.attr(button,"data-events"));BX.Type.isPlainObject(events)&&(BX.Dom.attr(button,"data-events",null),_this3.bindOnEvents(button,events))}))},onElementClick:function(t){t.stopPropagation()},bindOnEvents:function bindOnEvents(button,events){if(BX.Type.isDomNode(button)&&BX.Type.isPlainObject(events)){BX.Event.bind(button,"click",this.onElementClick.bind(this));var target=(selector=BX.Dom.attr(button,"data-target"),selector?button.closest(selector):button),event=new BX.Event.BaseEvent({data:{button:button,target:target,row:this}});event.setTarget(target),Object.entries(events).forEach((function(_ref3){var _ref4=babelHelpers.slicedToArray(_ref3,2),eventName=_ref4[0],handler=_ref4[1],preparedHandler=eval(handler);BX.Event.bind(button,eventName,preparedHandler.bind(null,event))}))}var selector},setCounters:function(t){var e=this;BX.Type.isPlainObject(t)&&Object.entries(t).forEach((function(t){var n,i=babelHelpers.slicedToArray(t,2),s=i[0],a=i[1],o=e.getCellById(s);if(BX.Type.isDomNode(o)){var r=o.querySelector(".main-grid-cell-inner"),l=(n=o.querySelector(".main-grid-cell-counter"),BX.Type.isDomNode(n)?n:BX.Tag.render(_templateObject13||(_templateObject13=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t<span class="main-grid-cell-counter"></span>\n\t\t\t\t\t\t\t'])))),d=function(){var t=l.querySelector(".ui-counter");if(BX.Type.isDomNode(t))return t;var e=BX.Tag.render(_templateObject14||(_templateObject14=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t<span class="ui-counter"></span>\n\t\t\t\t\t\t\t'])));return BX.Dom.append(e,l),e}();BX.Type.isPlainObject(a.events)&&e.bindOnEvents(d,a.events);var u=function(){var t=d.querySelector(".ui-counter-inner");if(BX.Type.isDomNode(t))return t;var e=BX.Tag.render(_templateObject15||(_templateObject15=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t\t<span class="ui-counter-inner"></span>\n\t\t\t\t\t\t\t'])));return BX.Dom.append(e,d),e}();if(BX.Type.isStringFilled(a.type)&&(Object.values(BX.Grid.Counters.Type).forEach((function(t){BX.Dom.removeClass(l,"main-grid-cell-counter-".concat(t))})),BX.Dom.addClass(l,"main-grid-cell-counter-".concat(a.type))),BX.Type.isStringFilled(a.color)&&(Object.values(BX.Grid.Counters.Color).forEach((function(t){BX.Dom.removeClass(d,t)})),BX.Dom.addClass(d,a.color)),BX.Type.isStringFilled(a.size)&&(Object.values(BX.Grid.Counters.Size).forEach((function(t){BX.Dom.removeClass(d,t)})),BX.Dom.addClass(d,a.size)),BX.Type.isStringFilled(a.class)&&BX.Dom.addClass(d,a.class),BX.Type.isStringFilled(a.value)||BX.Type.isNumber(a.value)){var c=BX.Text.toNumber(u.innerText),h=BX.Text.toNumber(a.value);h>0&&(u.innerText=h<100?a.value:"99+",!1!==a.animation&&(h!==c&&(h>c?BX.Dom.addClass(u,"ui-counter-plus"):BX.Dom.addClass(u,"ui-counter-minus")),BX.Event.bindOnce(u,"animationend",(function(t){"uiCounterPlus"!==t.animationName&&"uiCounterMinus"!==t.animationName||BX.Dom.removeClass(u,["ui-counter-plus","ui-counter-minus"])}))))}if(BX.Text.toNumber(a.value)>0){var p=a.type===BX.Grid.Counters.Type.RIGHT?"right":"left";"left"===p?BX.Dom.prepend(l,r):"right"===p&&BX.Dom.append(l,r)}else{var g="main-grid-cell-counter-".concat(BX.Grid.Counters.Type.LEFT_ALIGNED);BX.Dom.hasClass(l,g)?BX.remove(d):BX.remove(l)}}}))}}})();