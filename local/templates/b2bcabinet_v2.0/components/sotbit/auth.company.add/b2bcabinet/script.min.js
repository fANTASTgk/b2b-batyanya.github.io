function submitForm(){if(!document.querySelector(".main-user-consent-request input").checked)return;let e=getGet("EDIT_ID");if(!e)return t.append("save","Y"),void document.addOrg.submit();BX.showWait();let t=new FormData(document.addOrg);t.append("EDIT_ID",e),t.append("save","Y"),BX.ajax.runComponentAction("sotbit:auth.company.add","checkFields",{mode:"class",data:t}).then((function(e){if("Y"==e.data){if(BX.closeWait(),0==confirm(title_send_moderation))return!1;document.getElementById("apply").value="Y",document.addOrg.submit()}else document.getElementById("apply").value="N",BX.closeWait(),document.addOrg.submit()}))}function getGet(e){var t=window.location.search;return!!(t=t.match(new RegExp(e+"=([^&=]+)")))&&t[1]}function goToList(){document.location.href=path_to_list}$(document).on("change keyup input","#INN",(function(){var e=$(this).val();$("#NAME").val(e)})),$(document).on("change","input[name='PERSON_TYPE']",(function(){this.value;""!==this.value&&($("#change_person_type").val(!0),$("#PERSON_TYPE").val(this.value)),this.form.submit()}));const MultiAddress=function(){this.node=document.querySelector(".multi-address"),this.node&&(this.listAddress=this.node.querySelector(".multi-address-items"),this.countAddress=this.listAddress.children.length,this.btnAddAddress=this.node.querySelector('[data-action="add-address"]'),document.body.append(document.querySelector("#template-address-modal").content),this.modalAddAddress=new bootstrap.Modal(document.querySelector("#multi-address-modal")),this.formModalAddress=this.modalAddAddress._element.querySelector('form[name="add-address"]'))};function hideBlock(e){BX.remove(e.closest(".form-control-multiple-wrap"))}MultiAddress.prototype={init:function(){this.node&&(this.node.addEventListener("click",function(e){const t=e.target.closest("[data-action]");if(t)switch(t.dataset.action){case"edit":this.editAddress(t);break;case"delete":this.deleteAddress(t);break}}.bind(this)),this.btnAddAddress.addEventListener("click",function(){this.modalAddAddress._element.querySelector('[name="action"]').value="add",this.modalAddAddress._element.querySelectorAll("input.form-control").forEach((e=>e.value="")),this.modalAddAddress._element.querySelector('button[type="submit"]').innerHTML=BX.message("SOA_MULTIPLE_BTN")}.bind(this)),this.modalAddAddress._element.querySelector('form[name="add-address"]')?.addEventListener("submit",this.eventChangeAddress.bind(this)))},editAddress:function(e){const t=e.closest(".position-relative").querySelector("input"),s=this.modalAddAddress._element.querySelectorAll("input.form-control"),d=this.splitAddress(t.value);s.forEach(((e,t)=>{e.value=d[t]??""})),this.modalAddAddress._element.querySelector('[name="action"]').value="edit",this.modalAddAddress._element.querySelector('[name="address-key"]').value=t.dataset.key,this.modalAddAddress._element.querySelector('button[type="submit"]').innerHTML=BX.message("SOA_MULTIPLE_EDIT_BTN"),this.modalAddAddress.show()},deleteAddress:function(e){e.closest(".position-relative").remove(),this.node.querySelector(".multi-address-items").children.length||this.node.querySelectorAll('[type="hidden"]').forEach((e=>e.value=""))},eventChangeAddress:function(e){e.preventDefault();const t=this.formModalAddress.querySelectorAll("input.form-control");switch(this.formModalAddress.querySelector('[name="action"]').value){case"add":if(!this.listAddress.children.length){const e=this.node.querySelectorAll('[type="hidden"]');t.forEach(((t,s)=>{e[s].value=t.value}))}this.listAddress.append(this.createAddress(this.joinAddress(t)));break;case"edit":const e=this.formModalAddress.querySelector('[name="address-key"]').value;this.listAddress.querySelector(`.form-control[data-key="${e}"]`).value=this.joinAddress(t);break}this.formModalAddress.querySelector("[data-bs-dismiss]").click()},createAddress:function(e){return BX.create("div",{props:{className:"position-relative mb-2"},children:[BX.create("input",{props:{className:"form-control pe-6",name:"multi_address[]",value:e},dataset:{key:this.countAddress++}}),BX.create("div",{props:{className:"position-absolute end-0 top-50 translate-middle-y me-1 d-flex"},children:[BX.create("button",{props:{className:"btn btn-sm btn-link btn-icon bg-transparent text-muted",type:"button",title:BX.message("SOA_MULTIPLE_EDIT_BTN")},dataset:{action:"edit"},children:[BX.create("i",{props:{className:"ph-pencil-simple fs-base"}})]}),BX.create("button",{props:{className:"btn btn-sm btn-link btn-icon bg-transparent text-muted",type:"button",title:BX.message("SOA_MULTIPLE_DELETE_BTN")},dataset:{action:"delete"},children:[BX.create("i",{props:{className:"ph-x fs-base"}})]})]})]})},joinAddress:function(e){return[].map.call(e,(e=>e.value)).join("; ")},splitAddress:function(e){return e.split(";").map((e=>e.trim()))}},BX.ready((function(){(new MultiAddress).init();const e=document.querySelectorAll(".multiple-props button");if(!e)return;for(let t in e)BX.bind(e[t],"click",BX.delegate((function(e){if(!BX.type.isDomNode(e.target))return;let t=BX.create("input",{attrs:{className:"form-control mb-2",type:"text",name:e.target.getAttribute("data-add-name"),maxlength:e.target.getAttribute("data-add-maxlength")}}),s=BX.create("div",{attrs:{className:"form-control-multiple position-absolute end-0 top-50 translate-middle-y me-1",onclick:"hideBlock(this)"},children:[BX.create("button",{attrs:{className:"form-control-multiple-ic btn btn-sm btn-icon btn-link text-muted",type:"button"},children:[BX.create("i",{attrs:{className:"ph-x fs-base"}})]})]}),d=BX.create("div",{attrs:{className:"form-control-multiple-wrap"},children:[t,s]});e.target.parentNode.insertBefore(d,e.target)})));const t=document.querySelectorAll(".tab-personal-group");0!==t.length&&t.forEach((e=>{e.querySelector('.form-check-input[name="PERSON_TYPE"]:checked')&&!e.querySelector('.form-check-input[name="PERSON_TYPE"]:checked')&&(e.querySelector('.form-check-input[name="PERSON_TYPE"]').checked=!0)}))}));