$(document).ready((function(){SweetAlert.initComponents();const e=document.querySelector("#modal-staff-register"),r=e.querySelector(".modal-dialog"),a=e.querySelector('button[name="register_submit_button"]'),t=e.querySelector('form[name="regform"]'),o=e.querySelector(".regform-error"),s=document.querySelector("#modal-staff-confirm"),i=s.querySelector(".modal-dialog"),n=s.querySelector(".btn_confirm"),l=e.querySelector("a.register-referral-link"),c=document.querySelector("#modal-staff-referal-register"),d=c.querySelector("#referralform"),u=c.querySelector(".modal-dialog"),m=c.querySelector('button[name="referral_exit_button"]'),f=c.querySelector('button[name="referral_submit_button"]');function g(e){S(e),document.querySelector('button[data-bs-target="#modal-staff-confirm"]').click()}function S(e){t.reset(),d.reset(),o.innerHTML="",e.querySelector('[data-bs-dismiss="modal"]').click()}e&&(document.body.appendChild(e),document.body.appendChild(c),document.body.appendChild(s)),l.onclick=function(){e.querySelector('[data-bs-dismiss="modal"]').click()},m.onclick=function(){c.querySelector('[data-bs-dismiss="modal"]').click(),document.querySelector('[data-bs-target="#modal-staff-register"]').click()},f.onclick=function(){BX.showWait(u),registerFormData=new FormData(d);var e=document.querySelector(".referral-form .error-block");BX.ajax.runComponentAction("sotbit:auth.company.staff.register","sendReferralForm",{mode:"class",data:registerFormData}).then((function(r){if(!0===r.data.error)if(r.data.userId)n.setAttribute("data-staff-id",r.data.userId),g(c);else{let a='<div class="bitrix-error"><label class="validation-invalid-label errortext">'+r.data.errorMessage+"</label></div>";e.innerHTML=a}else S(c),SweetAlert.showSuccess(r.data.successMessage),BX.Main.gridManager.reload("STAFF_LIST",""),BX.Main.gridManager.reload("STAFF_UNCONFIRMED_LIST","");BX.closeWait()}))},a.onclick=function(){BX.showWait(r),registerFormData=new FormData(t),BX.ajax.runComponentAction("sotbit:auth.company.staff.register","sendForm",{signedParameters:window.arCompStaffRegisterParams,mode:"class",data:registerFormData}).then((function(r){if(!0===r.data.error)if(r.data.userId)n.setAttribute("data-staff-id",r.data.userId),g(e);else{let e="";for(var a in r.data.errorMessage)e+='<div class="bitrix-error"><label class="validation-invalid-label errortext">'+r.data.errorMessage[a]+"</label></div>";o.innerHTML=e}else S(t),SweetAlert.showSuccess(r.data.successMessage),BX.Main.gridManager.reload("STAFF_LIST",""),BX.Main.gridManager.reload("STAFF_UNCONFIRMED_LIST","");BX.closeWait()}))},n.onclick=function(){BX.showWait(i),BX.ajax.runComponentAction("sotbit:auth.company.staff.register","confirmStaff",{signedParameters:window.arCompStaffRegisterParams,mode:"class",data:registerFormData}).then((function(e){!1===e.data.error?(S(s),SweetAlert.showSuccess(e.data.successMessage)):(o.innerHTML='<div class="bitrix-error"><label class="validation-invalid-label errortext">'+e.data.errorMessage+"</label></div>",S(s)),BX.closeWait()}))}}));