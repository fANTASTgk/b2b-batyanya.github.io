function initFilterConditionsControl(t){var e=JSON.parse(t.data);e&&(window["filter_conditions_"+t.propertyID]=new FilterConditionsParameterControl(e,t))}function FilterConditionsParameterControl(t,e){this.params=e||{},this.data=t||{},BX.addCustomEvent("onTreeConditionsInit",BX.proxy(this.modifyTreeParams,this))}window.JCB2BExcelExport||(window.JCB2BExcelExport=function(t){this.siteId=t.siteId||"",this.componentPath=t.componentPath||"",this.parameters=t.parameters||"",this.btnExport=document.querySelector(t.btnSelector),this.filter=t.filter,this.cond_tree_params=t.cond_tree_params,this.btnExport&&BX.bind(this.btnExport,"click",BX.delegate(this.exportModeDefaultAction,this))},window.JCB2BExcelExport.prototype={exportModeDefaultAction:function(){this.setDisabled(!0),this.setIcon("spinner-grow vertical-align-top me-2"),BX.ajax.runComponentAction("sotbit:b2bcabinet.excel.export","exportExcel",{signedParameters:this.parameters,mode:"class",data:{arFilter:this.filter,condTreeParams:this.cond_tree_params}}).then(function(t){t.data.filePath&&this.downloadFile(t.data.filePath),this.setDisabled(!1),this.setDefaultIcon()}.bind(this),function(t){this.printConsoleError(t.errors),this.setDisabled(!1),this.setDefaultIcon()}.bind(this))},downloadFile(t){var e=new Date,o=e.getDate();o<10&&(o="0"+o);var r=e.getMonth()+1;r<10&&(r="0"+r);var i=e.getHours();i<10&&(i="0"+i);var n=e.getMinutes();n<10&&(n="0"+n);var a=e.getSeconds();a<10&&(a="0"+a);var s=1e9*Math.random()-.5;s=Math.round(s);var l="blank_"+e.getFullYear()+"_"+r+"_"+o+"_"+i+"_"+n+"_"+a+"_"+s+".xlsx",d=document.createElement("a");d.setAttribute("href",t),d.setAttribute("download",l);var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),d.dispatchEvent(c)},setIcon:function(t){this.btnExport.querySelector("i").setAttribute("class",t)},setDefaultIcon:function(){this.btnExport.querySelector("i").setAttribute("class","ph-arrow-line-up me-2")},setDisabled:function(t){this.btnExport.disabled=t},printConsoleError:function(t){t.forEach((function(t,e,o){}))}}),FilterConditionsParameterControl.prototype={deleteFromArray:function(t,e){if(BX.type.isArray(t)&&BX.type.isArray(e))for(var o=e.length;--o;)e[o]&&e.hasOwnProperty(o)&&BX.util.in_array(o,t)&&e.splice(o,1)},modifyTreeParams:function(t,e,o){if(o){var r,i,n=[];for(r in o)o.hasOwnProperty(r)&&((i=o[r]).group?this.modifyCondGroup(i):this.modifyCondValueGroup(i)&&n.push(r));this.deleteFromArray(n,o)}},modifyCondGroup:function(t){var e;if(t.visual)for(e in t.visual.values)t.visual.values.hasOwnProperty(e)&&"False"===t.visual.values[e].True&&(t.visual.values.splice(e,1),t.visual.logic.splice(e,1));if(t.control)for(e in t.control)t.control.hasOwnProperty(e)&&(t.control[e].dontShowFirstOption=!0,"True"===t.control[e].id&&delete t.control[e].values.False)},modifyCondValueGroup:function(t){if(t&&t.children&&t.children.length){var e,o,r,i=["CondIBXmlID","CondIBDateActiveFrom","CondIBDateActiveTo","CondIBSort","CondIBDateCreate","CondIBCreatedBy","CondIBTimestampX","CondIBModifiedBy","CondIBTags","CondCatQuantity","CondCatWeight"];for(var n in this.params.RIGHTS_DISPLAY_IBLOCK&&i.push("CondIBSection"),t.children)if(t.children.hasOwnProperty(n)){if(o=t.children[n],e=!0,BX.util.in_array(o.controlId,i))e=!1;else{if((r=o.controlId.split(":"))[1]&&r[1]!=this.data.iblockId&&r[1]!=this.data.offersIblockId)return!0;"CondIBProp"===r[0]&&r[2]&&(e=!1)}e&&delete t.children[n]}return t.children=t.children.filter((function(t){return t})),!1}}};